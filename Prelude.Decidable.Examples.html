<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Prelude.Decidable.Examples</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/formal-prelude/tree/master/Prelude/Decidable/Examples.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--with-K</a> <a id="29" class="Symbol">#-}</a>
<a id="33" class="Keyword">module</a> <a id="40" href="Prelude.Decidable.Examples.html" class="Module">Prelude.Decidable.Examples</a> <a id="67" class="Keyword">where</a>

<a id="74" class="Keyword">open</a> <a id="79" class="Keyword">import</a> <a id="86" href="Prelude.Init.html" class="Module">Prelude.Init</a><a id="98" class="Symbol">;</a> <a id="100" class="Keyword">open</a> <a id="105" href="Prelude.Init.html#504" class="Module">SetAsType</a>
<a id="115" class="Keyword">open</a> <a id="120" class="Keyword">import</a> <a id="127" href="Prelude.DecEq.Core.html" class="Module">Prelude.DecEq.Core</a>
<a id="146" class="Keyword">open</a> <a id="151" class="Keyword">import</a> <a id="158" href="Prelude.DecEq.WithK.html" class="Module">Prelude.DecEq.WithK</a>
<a id="178" class="Keyword">open</a> <a id="183" class="Keyword">import</a> <a id="190" href="Prelude.Nary.html" class="Module">Prelude.Nary</a>

<a id="204" class="Keyword">open</a> <a id="209" class="Keyword">import</a> <a id="216" href="Prelude.Decidable.Core.html" class="Module">Prelude.Decidable.Core</a>
<a id="239" class="Keyword">open</a> <a id="244" class="Keyword">import</a> <a id="251" href="Prelude.Decidable.Instances.html" class="Module">Prelude.Decidable.Instances</a>

<a id="280" class="Keyword">private</a>
  <a id="290" href="Prelude.Decidable.Examples.html#290" class="Function">_</a> <a id="292" class="Symbol">=</a> <a id="294" class="Symbol">(</a><a id="295" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="297" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="299" class="Symbol">((</a><a id="301" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a> <a id="306" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="308" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a><a id="312" class="Symbol">)</a> <a id="314" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="316" class="Symbol">(</a><a id="317" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a> <a id="322" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="324" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a><a id="328" class="Symbol">)))</a>
    <a id="336" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="338" class="Symbol">(</a><a id="339" class="Number">8</a> <a id="341" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="343" class="Number">18</a> <a id="346" href="Data.Nat.Base.html#2883" class="Primitive Operator">∸</a> <a id="348" class="Number">10</a><a id="350" class="Symbol">)</a>
    <a id="356" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="358" href="Prelude.Decidable.Core.html#181" class="Function">auto</a>

  <a id="366" href="Prelude.Decidable.Examples.html#366" class="Function">_</a> <a id="368" class="Symbol">=</a> <a id="370" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="372" class="Symbol">(</a> <a id="374" class="Symbol">(</a><a id="375" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="377" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="379" class="Symbol">((</a><a id="381" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a> <a id="386" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="388" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a><a id="392" class="Symbol">)</a> <a id="394" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="396" class="Symbol">(</a><a id="397" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a> <a id="402" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="404" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a><a id="408" class="Symbol">)))</a>
        <a id="420" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="422" class="Symbol">(</a><a id="423" class="Number">8</a> <a id="425" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="427" class="Number">17</a> <a id="430" href="Data.Nat.Base.html#2883" class="Primitive Operator">∸</a> <a id="432" class="Number">10</a><a id="434" class="Symbol">)</a> <a id="436" class="Symbol">)</a>
    <a id="442" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="444" href="Prelude.Decidable.Core.html#181" class="Function">auto</a>

  <a id="452" href="Prelude.Decidable.Examples.html#452" class="Function">_</a> <a id="454" class="Symbol">:</a> <a id="456" class="Symbol">∀</a> <a id="458" class="Symbol">{</a><a id="459" href="Prelude.Decidable.Examples.html#459" class="Bound">A</a> <a id="461" class="Symbol">:</a> <a id="463" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="468" href="Prelude.Init.html#261" class="Generalizable">ℓ</a><a id="469" class="Symbol">}</a>
    <a id="475" class="Symbol">→</a> <a id="477" class="Symbol">⦃</a> <a id="479" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="485" href="Prelude.Decidable.Examples.html#459" class="Bound">A</a> <a id="487" class="Symbol">⦄</a>
    <a id="493" class="Symbol">→</a> <a id="495" class="Symbol">{</a><a id="496" href="Prelude.Decidable.Examples.html#496" class="Bound">m</a> <a id="498" class="Symbol">:</a> <a id="500" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="506" class="Symbol">(</a><a id="507" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="512" href="Prelude.Decidable.Examples.html#459" class="Bound">A</a><a id="513" class="Symbol">)}</a> <a id="516" class="Symbol">{</a><a id="517" href="Prelude.Decidable.Examples.html#517" class="Bound">x₁</a> <a id="520" href="Prelude.Decidable.Examples.html#520" class="Bound">x₂</a> <a id="523" class="Symbol">:</a> <a id="525" href="Prelude.Decidable.Examples.html#459" class="Bound">A</a><a id="526" class="Symbol">}</a>
    <a id="532" class="Symbol">→</a> <a id="534" href="Relation.Nullary.html#1520" class="Record">Dec</a> <a id="538" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="540" href="Data.Maybe.Relation.Unary.Any.html#839" class="Datatype">M.Any.Any</a> <a id="550" class="Symbol">(λ</a> <a id="553" href="Prelude.Decidable.Examples.html#553" class="Bound">xs</a> <a id="556" class="Symbol">→</a> <a id="558" class="Symbol">(</a><a id="559" href="Prelude.Decidable.Examples.html#553" class="Bound">xs</a> <a id="562" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="564" href="Prelude.Nary.html#246" class="Function Operator">⟦</a> <a id="566" href="Prelude.Decidable.Examples.html#517" class="Bound">x₁</a> <a id="569" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="571" href="Prelude.Decidable.Examples.html#520" class="Bound">x₂</a> <a id="574" href="Prelude.Nary.html#246" class="Function Operator">⟧</a><a id="575" class="Symbol">)</a> <a id="577" href="Data.Sum.Base.html#743" class="Datatype Operator">⊎</a> <a id="579" href="Data.List.Relation.Unary.Any.html#1165" class="Datatype">Any</a> <a id="583" class="Symbol">(</a><a id="584" href="Function.Base.html#645" class="Function">const</a> <a id="590" href="Agda.Builtin.Unit.html#158" class="Record">⊤</a><a id="591" class="Symbol">)</a> <a id="593" href="Prelude.Decidable.Examples.html#553" class="Bound">xs</a><a id="595" class="Symbol">)</a> <a id="597" href="Prelude.Decidable.Examples.html#496" class="Bound">m</a>
  <a id="601" class="Symbol">_</a> <a id="603" class="Symbol">=</a> <a id="605" href="Prelude.Decidable.Core.html#166" class="Field">dec</a>

  <a id="612" class="Comment">-- ** Non-dependent records</a>
  <a id="642" class="Keyword">record</a> <a id="Valid"></a><a id="649" href="Prelude.Decidable.Examples.html#649" class="Record">Valid</a> <a id="655" class="Symbol">:</a> <a id="657" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="662" class="Keyword">where</a>
    <a id="672" class="Keyword">field</a>
      <a id="Valid.p₁"></a><a id="684" href="Prelude.Decidable.Examples.html#684" class="Field">p₁</a> <a id="687" class="Symbol">:</a> <a id="689" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="691" class="Symbol">(</a> <a id="693" class="Symbol">(</a><a id="694" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="696" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="698" class="Symbol">(</a><a id="699" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a> <a id="704" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="706" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a><a id="710" class="Symbol">))</a>
             <a id="726" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="728" class="Symbol">(</a><a id="729" class="Number">8</a> <a id="731" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="733" class="Number">17</a> <a id="736" href="Data.Nat.Base.html#2883" class="Primitive Operator">∸</a> <a id="738" class="Number">10</a><a id="740" class="Symbol">)</a> <a id="742" class="Symbol">)</a>
      <a id="Valid.p₂"></a><a id="750" href="Prelude.Decidable.Examples.html#750" class="Field">p₂</a> <a id="753" class="Symbol">:</a> <a id="755" class="Symbol">(</a><a id="756" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="758" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="760" class="Symbol">(</a><a id="761" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a> <a id="766" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="768" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a><a id="772" class="Symbol">))</a>
         <a id="784" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="786" class="Symbol">(</a><a id="787" class="Number">8</a> <a id="789" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="791" class="Number">18</a> <a id="794" href="Data.Nat.Base.html#2883" class="Primitive Operator">∸</a> <a id="796" class="Number">10</a><a id="798" class="Symbol">)</a>
  <a id="802" class="Keyword">open</a> <a id="807" href="Prelude.Decidable.Examples.html#649" class="Module">Valid</a>

  <a id="t"></a><a id="816" href="Prelude.Decidable.Examples.html#816" class="Function">t</a> <a id="818" class="Symbol">:</a> <a id="820" href="Prelude.Decidable.Examples.html#649" class="Record">Valid</a> <a id="826" href="Prelude.Decidable.Core.html#110" class="Record Operator">⁇</a>
  <a id="830" href="Prelude.Decidable.Examples.html#816" class="Function">t</a> <a id="832" class="Symbol">.</a><a id="833" href="Prelude.Decidable.Core.html#166" class="Field">dec</a>
    <a id="841" class="Keyword">with</a> <a id="846" href="Prelude.Decidable.Core.html#166" class="Field">dec</a>
  <a id="852" class="Symbol">...</a> <a id="856" class="Symbol">|</a> <a id="858" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="861" href="Prelude.Decidable.Examples.html#861" class="Bound">¬p₁</a> <a id="865" class="Symbol">=</a> <a id="867" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a>  <a id="871" class="Symbol">(</a><a id="872" href="Prelude.Decidable.Examples.html#861" class="Bound">¬p₁</a> <a id="876" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="878" href="Prelude.Decidable.Examples.html#684" class="Field">p₁</a><a id="880" class="Symbol">)</a>
  <a id="884" class="Symbol">...</a> <a id="888" class="Symbol">|</a> <a id="890" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="894" href="Prelude.Decidable.Examples.html#894" class="Bound">p₁</a>
    <a id="901" class="Keyword">with</a> <a id="906" href="Prelude.Decidable.Core.html#166" class="Field">dec</a>
  <a id="912" class="Symbol">...</a> <a id="916" class="Symbol">|</a> <a id="918" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="921" href="Prelude.Decidable.Examples.html#921" class="Bound">¬p₂</a> <a id="925" class="Symbol">=</a> <a id="927" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a>  <a id="931" class="Symbol">(</a><a id="932" href="Prelude.Decidable.Examples.html#921" class="Bound">¬p₂</a> <a id="936" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="938" href="Prelude.Decidable.Examples.html#750" class="Field">p₂</a><a id="940" class="Symbol">)</a>
  <a id="944" class="Symbol">...</a> <a id="948" class="Symbol">|</a> <a id="950" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="954" href="Prelude.Decidable.Examples.html#954" class="Bound">p₂</a> <a id="957" class="Symbol">=</a> <a id="959" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="963" class="Keyword">record</a> <a id="970" class="Symbol">{</a><a id="971" href="Prelude.Decidable.Examples.html#684" class="Field">p₁</a> <a id="974" class="Symbol">=</a> <a id="976" class="Bound">p₁</a><a id="978" class="Symbol">;</a> <a id="980" href="Prelude.Decidable.Examples.html#750" class="Field">p₂</a> <a id="983" class="Symbol">=</a> <a id="985" href="Prelude.Decidable.Examples.html#954" class="Bound">p₂</a><a id="987" class="Symbol">}</a>

<a id="990" class="Comment">{-
  -- ** Dependent records (simple)
  record Valid : Type where
    field
      p₁ : ⊤
      p₂ : ¬ ( (¬ ¬ (tt ≡ p₁))
             × (8 ≡ 17 ∸ 10) )
  open Valid

  t : Valid ⁇
  t .dec
    with dec
  ... | no ¬p₁ = no  (¬p₁ ∘ p₁)
  ... | yes p₁
    with dec
  ... | no ¬p₂ = no  {!!} -- (¬p₂ ∘ p₂) -- doesn&#39;t work because of dependency between p₁ and p₂
  ... | yes p₂ = yes record {p₁ = p₁; p₂ = p₂}
-}</a>

<a id="1398" class="Comment">{-
  -- ** Dependent records (advanced)
  record Valid ⦃ da : DecEq A ⦄ (m : Maybe (List A)) (x₁ x₂ : A) : Type where
    field
      p₁ : M.Any.Any (λ xs → ( (xs ≡ ⟦ x₁ , x₂ ⟧)
                            × (Any (const ⊤) xs)
                            ⊎ (_⊆_ (_≟_ ⦃ da ⦄) ⟦ x₁ , x₂ ⟧ xs)
                            )) m

      p₂ : proj₁ (M.Any.satisfied p₁) ≡ ⟦ x₁ , x₂ ⟧
  open Valid

  t : ∀ ⦃ DecEq A ⦄ {m : Maybe (List A)} {x₁ x₂} → (Valid m x₁ x₂) ⁇
  t .dec
    with dec
  ... | no ¬p₁ = no  (¬p₁ ∘ p₁)
  ... | yes p₁
    with dec
  ... | no ¬p₂ = no  {!!} -- (¬p₂ ∘ p₂) -- doesn&#39;t work because of dependency between p₁ and p₂
  ... | yes p₂ = yes record {p₁ = p₁; p₂ = p₂}
-}</a>
</pre></body></html>