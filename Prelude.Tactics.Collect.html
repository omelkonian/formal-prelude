<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Prelude.Tactics.Collect</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/formal-prelude/tree/master/Prelude/Tactics/Collect.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--with-K</a> <a id="22" class="Symbol">#-}</a>
<a id="26" class="Symbol">{-#</a> <a id="30" class="Keyword">OPTIONS</a> <a id="38" class="Pragma">-v</a> <a id="41" class="Pragma">collect:100</a> <a id="53" class="Symbol">#-}</a>
<a id="57" class="Keyword">module</a> <a id="64" href="Prelude.Tactics.Collect.html" class="Module">Prelude.Tactics.Collect</a> <a id="88" class="Keyword">where</a>

<a id="95" class="Keyword">open</a> <a id="100" class="Keyword">import</a> <a id="107" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="131" class="Keyword">using</a> <a id="137" class="Symbol">(</a><a id="138" href="Agda.Builtin.Reflection.html#11007" class="Postulate">getInstances</a><a id="150" class="Symbol">)</a>

<a id="153" class="Keyword">open</a> <a id="158" class="Keyword">import</a> <a id="165" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="178" class="Keyword">open</a> <a id="183" href="Prelude.Init.html#12240" class="Module">Meta</a>
<a id="188" class="Keyword">open</a> <a id="193" class="Keyword">import</a> <a id="200" href="Prelude.Generics.html" class="Module">Prelude.Generics</a>
<a id="217" class="Keyword">open</a> <a id="222" href="Prelude.Generics.Debug.html#648" class="Module">Debug</a> <a id="228" class="Symbol">(</a><a id="229" class="String">&quot;collect&quot;</a> <a id="239" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="241" class="Number">100</a><a id="244" class="Symbol">)</a>
<a id="246" class="Keyword">open</a> <a id="251" class="Keyword">import</a> <a id="258" href="Prelude.Monad.html" class="Module">Prelude.Monad</a>
<a id="272" class="Keyword">open</a> <a id="277" class="Keyword">import</a> <a id="284" href="Prelude.Show.html" class="Module">Prelude.Show</a>
<a id="297" class="Keyword">open</a> <a id="302" class="Keyword">import</a> <a id="309" href="Prelude.Semigroup.html" class="Module">Prelude.Semigroup</a>
<a id="327" class="Keyword">open</a> <a id="332" class="Keyword">import</a> <a id="339" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="355" class="Keyword">open</a> <a id="360" class="Keyword">import</a> <a id="367" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="381" class="Keyword">open</a> <a id="386" class="Keyword">import</a> <a id="393" href="Prelude.Foldable.html" class="Module">Prelude.Foldable</a>
<a id="410" class="Keyword">open</a> <a id="415" class="Keyword">import</a> <a id="422" href="Prelude.Traversable.html" class="Module">Prelude.Traversable</a>
<a id="442" class="Keyword">open</a> <a id="447" class="Keyword">import</a> <a id="454" href="Prelude.Membership.html" class="Module">Prelude.Membership</a>
<a id="473" class="Keyword">open</a> <a id="478" class="Keyword">import</a> <a id="485" href="Prelude.Lists.Dec.html" class="Module">Prelude.Lists.Dec</a>

<a id="504" class="Keyword">private</a>
  <a id="514" class="Symbol">{-#</a> <a id="518" class="Keyword">TERMINATING</a> <a id="530" class="Symbol">#-}</a>
  <a id="names"></a><a id="536" href="Prelude.Tactics.Collect.html#536" class="Function">names</a> <a id="542" class="Symbol">:</a> <a id="544" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="549" class="Symbol">→</a> <a id="551" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="556" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a>
  <a id="563" href="Prelude.Tactics.Collect.html#536" class="Function">names</a> <a id="569" class="Symbol">=</a> <a id="571" href="Prelude.Tactics.Collect.html#580" class="Function">go</a> <a id="574" class="Keyword">where</a> <a id="580" href="Prelude.Tactics.Collect.html#580" class="Function">go</a> <a id="583" class="Symbol">=</a> <a id="585" class="Symbol">λ</a> <a id="587" class="Keyword">where</a>
    <a id="597" class="Symbol">(</a><a id="598" href="Agda.Builtin.Reflection.html#4815" class="InductiveConstructor">var</a> <a id="602" href="Prelude.Tactics.Collect.html#602" class="Bound">x</a> <a id="604" href="Prelude.Tactics.Collect.html#604" class="Bound">as</a><a id="606" class="Symbol">)</a> <a id="608" class="Symbol">→</a> <a id="610" href="Data.List.Base.html#4459" class="Function">concatMap</a> <a id="620" class="Symbol">(</a><a id="621" href="Prelude.Tactics.Collect.html#580" class="Function">go</a> <a id="624" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="626" href="Reflection.Argument.html#2530" class="Function">unArg</a><a id="631" class="Symbol">)</a> <a id="633" href="Prelude.Tactics.Collect.html#604" class="Bound">as</a>
    <a id="640" class="Symbol">(</a><a id="641" href="Agda.Builtin.Reflection.html#4871" class="InductiveConstructor">con</a> <a id="645" href="Prelude.Tactics.Collect.html#645" class="Bound">c</a> <a id="647" href="Prelude.Tactics.Collect.html#647" class="Bound">as</a><a id="649" class="Symbol">)</a> <a id="651" class="Symbol">→</a> <a id="653" href="Prelude.Tactics.Collect.html#645" class="Bound">c</a> <a id="655" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="657" href="Data.List.Base.html#4459" class="Function">concatMap</a> <a id="667" class="Symbol">(</a><a id="668" href="Prelude.Tactics.Collect.html#580" class="Function">go</a> <a id="671" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="673" href="Reflection.Argument.html#2530" class="Function">unArg</a><a id="678" class="Symbol">)</a> <a id="680" href="Prelude.Tactics.Collect.html#647" class="Bound">as</a>
    <a id="687" class="Symbol">(</a><a id="688" href="Agda.Builtin.Reflection.html#4928" class="InductiveConstructor">def</a> <a id="692" href="Prelude.Tactics.Collect.html#692" class="Bound">f</a> <a id="694" href="Prelude.Tactics.Collect.html#694" class="Bound">as</a><a id="696" class="Symbol">)</a> <a id="698" class="Symbol">→</a> <a id="700" href="Prelude.Tactics.Collect.html#692" class="Bound">f</a> <a id="702" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="704" href="Data.List.Base.html#4459" class="Function">concatMap</a> <a id="714" class="Symbol">(</a><a id="715" href="Prelude.Tactics.Collect.html#580" class="Function">go</a> <a id="718" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="720" href="Reflection.Argument.html#2530" class="Function">unArg</a><a id="725" class="Symbol">)</a> <a id="727" href="Prelude.Tactics.Collect.html#694" class="Bound">as</a>
    <a id="734" class="Symbol">(</a><a id="735" href="Agda.Builtin.Reflection.html#4985" class="InductiveConstructor">lam</a> <a id="739" href="Prelude.Tactics.Collect.html#739" class="Bound">v</a> <a id="741" href="Prelude.Tactics.Collect.html#741" class="Bound">t</a><a id="742" class="Symbol">)</a>  <a id="745" class="Symbol">→</a> <a id="747" href="Prelude.Tactics.Collect.html#580" class="Function">go</a> <a id="750" class="Symbol">(</a><a id="751" href="Reflection.Abstraction.html#1738" class="Function">unAbs</a> <a id="757" href="Prelude.Tactics.Collect.html#741" class="Bound">t</a><a id="758" class="Symbol">)</a>
    <a id="764" class="Symbol">(</a><a id="765" href="Agda.Builtin.Reflection.html#5103" class="InductiveConstructor">pi</a> <a id="768" href="Prelude.Tactics.Collect.html#768" class="Bound">a</a> <a id="770" href="Prelude.Tactics.Collect.html#770" class="Bound">b</a><a id="771" class="Symbol">)</a> <a id="773" class="Symbol">→</a> <a id="775" href="Prelude.Tactics.Collect.html#580" class="Function">go</a> <a id="778" class="Symbol">(</a><a id="779" href="Reflection.Argument.html#2530" class="Function">unArg</a> <a id="785" href="Prelude.Tactics.Collect.html#768" class="Bound">a</a><a id="786" class="Symbol">)</a> <a id="788" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="791" href="Prelude.Tactics.Collect.html#580" class="Function">go</a> <a id="794" class="Symbol">(</a><a id="795" href="Reflection.Abstraction.html#1738" class="Function">unAbs</a> <a id="801" href="Prelude.Tactics.Collect.html#770" class="Bound">b</a><a id="802" class="Symbol">)</a>
    <a id="808" class="CatchallClause Symbol">_</a> <a id="810" class="Symbol">→</a> <a id="812" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>

<a id="816" class="Comment">-- using hard-coded (static) list of collection functions</a>
<a id="874" class="Keyword">module</a> <a id="Collect"></a><a id="881" href="Prelude.Tactics.Collect.html#881" class="Module">Collect</a> <a id="889" class="Symbol">(</a><a id="890" href="Prelude.Tactics.Collect.html#890" class="Bound">fs</a> <a id="893" class="Symbol">:</a> <a id="895" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="900" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="904" class="Symbol">)</a> <a id="906" class="Keyword">where</a> <a id="912" class="Keyword">macro</a>
  <a id="Collect.collect"></a><a id="920" href="Prelude.Tactics.Collect.html#920" class="Function">collect</a> <a id="928" class="Symbol">:</a> <a id="930" href="Prelude.Generics.Core.html#2386" class="Function">Tactic</a>
  <a id="939" href="Prelude.Tactics.Collect.html#920" class="Function">collect</a> <a id="947" href="Prelude.Tactics.Collect.html#947" class="Bound">hole</a> <a id="952" class="Symbol">=</a> <a id="954" class="Keyword">do</a>
    <a id="961" href="Prelude.Tactics.Collect.html#961" class="Bound">goal</a> <a id="966" href="Prelude.Monad.html#590" class="Field Operator">←</a> <a id="968" href="Agda.Builtin.Reflection.html#8555" class="Postulate">inferType</a> <a id="978" href="Prelude.Tactics.Collect.html#947" class="Bound">hole</a> <a id="983" class="Comment">-- &gt;&gt;= reduce</a>
    <a id="1001" href="Prelude.Generics.Debug.html#768" class="Function">print</a> <a id="1007" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1009" class="String">&quot;Retrieving collection for: &quot;</a> <a id="1039" href="Prelude.Semigroup.html#251" class="Field Operator">◇</a> <a id="1041" href="Prelude.Show.html#351" class="Field">show</a> <a id="1046" href="Prelude.Tactics.Collect.html#961" class="Bound">goal</a>
    <a id="1055" class="Keyword">let</a> <a id="1059" href="Prelude.Tactics.Collect.html#1059" class="Bound">ns</a> <a id="1062" class="Symbol">=</a> <a id="1064" href="Prelude.Tactics.Collect.html#536" class="Function">names</a> <a id="1070" href="Prelude.Tactics.Collect.html#961" class="Bound">goal</a>
    <a id="1079" href="Prelude.Generics.Debug.html#768" class="Function">print</a> <a id="1085" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1087" class="String">&quot;Names: &quot;</a> <a id="1097" href="Prelude.Semigroup.html#251" class="Field Operator">◇</a> <a id="1099" href="Prelude.Show.html#351" class="Field">show</a> <a id="1104" href="Prelude.Tactics.Collect.html#1059" class="Bound">ns</a>
    <a id="1111" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="1116" href="Prelude.Tactics.Collect.html#1116" class="Bound">f</a> <a id="1118" href="Prelude.Monad.html#590" class="Field Operator">←</a> <a id="1120" href="Data.List.Base.html#7070" class="Function">L.head</a> <a id="1127" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="1129" href="Data.List.Base.html#4403" class="Function">concat</a> <a id="1136" href="Prelude.Functor.html#382" class="Field Operator">&lt;$&gt;</a> <a id="1140" href="Prelude.Monad.html#3813" class="Function">forM</a> <a id="1145" href="Prelude.Tactics.Collect.html#890" class="Bound">fs</a> <a id="1148" class="Symbol">λ</a> <a id="1150" href="Prelude.Tactics.Collect.html#1150" class="Bound">f</a> <a id="1152" class="Symbol">→</a> <a id="1154" class="Keyword">do</a>
      <a id="1163" href="Prelude.Tactics.Collect.html#1163" class="Bound">ty</a> <a id="1166" href="Prelude.Monad.html#590" class="Field Operator">←</a> <a id="1168" href="Agda.Builtin.Reflection.html#9373" class="Postulate">getType</a> <a id="1176" href="Prelude.Tactics.Collect.html#1150" class="Bound">f</a>
      <a id="1184" href="Prelude.Monad.html#569" class="Field">return</a> <a id="1191" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1193" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="1196" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌊</a> <a id="1198" href="Prelude.Tactics.Collect.html#1059" class="Bound">ns</a> <a id="1201" href="Prelude.Lists.Dec.html#1440" class="Function Operator">⊆?</a> <a id="1204" href="Prelude.Tactics.Collect.html#536" class="Function">names</a> <a id="1210" href="Prelude.Tactics.Collect.html#1163" class="Bound">ty</a> <a id="1213" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌋</a> <a id="1215" href="Data.Bool.Base.html#1292" class="Function Operator">then</a> <a id="1220" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="1222" href="Prelude.Tactics.Collect.html#1150" class="Bound">f</a> <a id="1224" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="1226" href="Data.Bool.Base.html#1292" class="Function Operator">else</a> <a id="1231" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>
     <a id="1239" class="Keyword">where</a> <a id="1245" class="CatchallClause Symbol">_</a> <a id="1247" class="Symbol">→</a> <a id="1249" href="Prelude.Generics.Debug.html#530" class="Function">error</a> <a id="1255" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1257" class="String">&quot;no implementation found in: &quot;</a> <a id="1288" href="Prelude.Semigroup.html#251" class="Field Operator">◇</a> <a id="1290" href="Prelude.Show.html#351" class="Field">show</a> <a id="1295" href="Prelude.Tactics.Collect.html#890" class="Bound">fs</a>
    <a id="1302" href="Agda.Builtin.Reflection.html#8452" class="Postulate">unify</a> <a id="1308" href="Prelude.Tactics.Collect.html#947" class="Bound">hole</a> <a id="1313" class="Symbol">(</a><a id="1314" href="Prelude.Tactics.Collect.html#1116" class="Bound">f</a> <a id="1316" href="Prelude.Generics.Core.html#1747" class="InductiveConstructor Operator">∙</a><a id="1317" class="Symbol">)</a>

<a id="1320" class="Keyword">private</a>
  <a id="f"></a><a id="1330" href="Prelude.Tactics.Collect.html#1330" class="Function">f</a> <a id="1332" class="Symbol">:</a> <a id="1334" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="1336" class="Symbol">→</a> <a id="1338" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1343" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a>
  <a id="1347" href="Prelude.Tactics.Collect.html#1330" class="Function">f</a> <a id="1349" href="Prelude.Tactics.Collect.html#1349" class="Bound">n</a> <a id="1351" class="Symbol">=</a> <a id="1353" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="1355" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="1357" href="Prelude.Tactics.Collect.html#1349" class="Bound">n</a> <a id="1359" href="Data.List.Base.html#5034" class="Function Operator">]</a>
  <a id="g"></a><a id="1363" href="Prelude.Tactics.Collect.html#1363" class="Function">g</a> <a id="1365" class="Symbol">:</a> <a id="1367" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="1369" class="Symbol">→</a> <a id="1371" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a id="1375" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a> <a id="1377" class="Number">1</a>
  <a id="1381" href="Prelude.Tactics.Collect.html#1363" class="Function">g</a> <a id="1383" href="Prelude.Tactics.Collect.html#1383" class="Bound">n</a> <a id="1385" class="Symbol">=</a> <a id="1387" href="Data.Vec.Base.html#5759" class="Function Operator">V.[</a> <a id="1391" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="1393" href="Prelude.Tactics.Collect.html#1383" class="Bound">n</a> <a id="1395" href="Data.Vec.Base.html#5759" class="Function Operator">]</a>
  <a id="fs"></a><a id="1399" href="Prelude.Tactics.Collect.html#1399" class="Function">fs</a> <a id="1402" class="Symbol">:</a> <a id="1404" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="1411" class="Symbol">→</a> <a id="1413" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1418" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a>
  <a id="1422" href="Prelude.Tactics.Collect.html#1399" class="Function">fs</a> <a id="1425" class="Symbol">_</a> <a id="1427" class="Symbol">=</a> <a id="1429" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="1431" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="1433" class="Number">0</a> <a id="1435" href="Data.List.Base.html#5034" class="Function Operator">]</a>

  <a id="1440" class="Keyword">open</a> <a id="1445" href="Prelude.Tactics.Collect.html#881" class="Module">Collect</a> <a id="1453" class="Symbol">(</a><a id="1454" class="Keyword">quote</a> <a id="1460" href="Prelude.Tactics.Collect.html#1330" class="Function">f</a> <a id="1462" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1464" class="Keyword">quote</a> <a id="1470" href="Prelude.Tactics.Collect.html#1363" class="Function">g</a> <a id="1472" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1474" class="Keyword">quote</a> <a id="1480" href="Prelude.Tactics.Collect.html#1399" class="Function">fs</a> <a id="1483" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1485" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="1487" class="Symbol">)</a>

  <a id="1492" class="Comment">-- DOES NOT WORK: expects List to the right of _≡_</a>
  <a id="1545" class="Comment">-- _ = collect 5 ≡ V.[ + 5 ] ∋ refl</a>

  <a id="1584" class="Comment">-- DOES NOT WORK: expects List to the left of _≡_</a>
  <a id="1636" class="Comment">-- _ = V.[ + 5 ] ≡ collect 5 ∋ refl</a>

  <a id="ex-f"></a><a id="1675" href="Prelude.Tactics.Collect.html#1675" class="Function">ex-f</a> <a id="1680" class="Symbol">:</a> <a id="1682" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="1684" class="Symbol">→</a> <a id="1686" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1691" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a>
  <a id="1695" href="Prelude.Tactics.Collect.html#1675" class="Function">ex-f</a> <a id="1700" class="Symbol">=</a> <a id="1702" href="Prelude.Tactics.Collect.html#920" class="Macro">collect</a>
  <a id="1712" href="Prelude.Tactics.Collect.html#1712" class="Function">_</a> <a id="1714" class="Symbol">=</a> <a id="1716" href="Prelude.Tactics.Collect.html#1675" class="Function">ex-f</a> <a id="1721" class="Number">5</a> <a id="1723" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1725" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="1727" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="1729" class="Number">5</a> <a id="1731" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="1733" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="1735" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

  <a id="ex-g"></a><a id="1743" href="Prelude.Tactics.Collect.html#1743" class="Function">ex-g</a> <a id="1748" class="Symbol">:</a> <a id="1750" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="1752" class="Symbol">→</a> <a id="1754" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a id="1758" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a> <a id="1760" class="Number">1</a>
  <a id="1764" href="Prelude.Tactics.Collect.html#1743" class="Function">ex-g</a> <a id="1769" class="Symbol">=</a> <a id="1771" href="Prelude.Tactics.Collect.html#920" class="Macro">collect</a>
  <a id="1781" href="Prelude.Tactics.Collect.html#1781" class="Function">_</a> <a id="1783" class="Symbol">=</a> <a id="1785" href="Prelude.Tactics.Collect.html#1743" class="Function">ex-g</a> <a id="1790" class="Number">5</a> <a id="1792" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1794" href="Data.Vec.Base.html#5759" class="Function Operator">V.[</a> <a id="1798" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="1800" class="Number">5</a> <a id="1802" href="Data.Vec.Base.html#5759" class="Function Operator">]</a> <a id="1804" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="1806" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

  <a id="ex-fs"></a><a id="1814" href="Prelude.Tactics.Collect.html#1814" class="Function">ex-fs</a> <a id="1820" class="Symbol">:</a> <a id="1822" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="1829" class="Symbol">→</a> <a id="1831" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1836" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a>
  <a id="1840" href="Prelude.Tactics.Collect.html#1814" class="Function">ex-fs</a> <a id="1846" class="Symbol">=</a> <a id="1848" href="Prelude.Tactics.Collect.html#920" class="Macro">collect</a>
  <a id="1858" href="Prelude.Tactics.Collect.html#1858" class="Function">_</a> <a id="1860" class="Symbol">=</a> <a id="1862" href="Prelude.Tactics.Collect.html#1814" class="Function">ex-fs</a> <a id="1868" class="String">&quot;sth&quot;</a> <a id="1874" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1876" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="1878" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="1880" class="Number">0</a> <a id="1882" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="1884" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="1886" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

<a id="1892" class="Comment">-- ** using (internal) instance search</a>
<a id="1931" class="Keyword">private</a>
  <a id="1941" class="Keyword">record</a> <a id="Collectible"></a><a id="1948" href="Prelude.Tactics.Collect.html#1948" class="Record">Collectible</a> <a id="1960" class="Symbol">(</a><a id="1961" href="Prelude.Tactics.Collect.html#1961" class="Bound">A</a> <a id="1963" class="Symbol">:</a> <a id="1965" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="1968" class="Symbol">)</a> <a id="1970" class="Symbol">:</a> <a id="1972" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="1976" class="Keyword">where</a>
    <a id="1986" class="Keyword">constructor</a> <a id="give_"></a><a id="1998" href="Prelude.Tactics.Collect.html#1998" class="InductiveConstructor Operator">give_</a>
    <a id="2008" class="Keyword">field</a> <a id="Collectible.collectName"></a><a id="2014" href="Prelude.Tactics.Collect.html#2014" class="Field">collectName</a> <a id="2026" class="Symbol">:</a> <a id="2028" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a>
  <a id="2035" class="Keyword">open</a> <a id="2040" href="Prelude.Tactics.Collect.html#1948" class="Module">Collectible</a> <a id="2052" class="Symbol">⦃...⦄</a>

<a id="REGISTER"></a><a id="2059" href="Prelude.Tactics.Collect.html#2059" class="Function">REGISTER</a> <a id="2068" class="Symbol">:</a> <a id="2070" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2075" class="Symbol">(</a><a id="2076" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="2081" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="2083" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="2087" class="Symbol">)</a> <a id="2089" class="Symbol">→</a> <a id="2091" href="Agda.Builtin.Reflection.html#8279" class="Postulate">TC</a> <a id="2094" href="Agda.Builtin.Unit.html#158" class="Record">⊤</a>
<a id="2096" href="Prelude.Tactics.Collect.html#2059" class="Function">REGISTER</a> <a id="2105" href="Prelude.Tactics.Collect.html#2105" class="Bound">ns</a> <a id="2108" class="Symbol">=</a> <a id="2110" href="Prelude.Monad.html#4029" class="Function">void</a> <a id="2115" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2117" href="Prelude.Monad.html#3813" class="Function">forM</a> <a id="2122" href="Prelude.Tactics.Collect.html#2105" class="Bound">ns</a> <a id="2125" class="Symbol">λ</a> <a id="2127" class="Symbol">(</a><a id="2128" href="Prelude.Tactics.Collect.html#2128" class="Bound">n</a> <a id="2130" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2132" href="Prelude.Tactics.Collect.html#2132" class="Bound">n′</a><a id="2134" class="Symbol">)</a> <a id="2136" class="Symbol">→</a> <a id="2138" class="Keyword">do</a>
  <a id="2143" href="Prelude.Tactics.Collect.html#2143" class="Bound">ty</a> <a id="2146" href="Prelude.Monad.html#590" class="Field Operator">←</a> <a id="2148" href="Agda.Builtin.Reflection.html#9373" class="Postulate">getType</a> <a id="2156" href="Prelude.Tactics.Collect.html#2128" class="Bound">n</a>
  <a id="2160" href="Prelude.Tactics.Collect.html#2160" class="Bound">`n</a> <a id="2163" href="Prelude.Monad.html#590" class="Field Operator">←</a> <a id="2165" href="Agda.Builtin.Reflection.html#8766" class="Postulate">quoteTC</a> <a id="2173" href="Prelude.Tactics.Collect.html#2128" class="Bound">n</a>
  <a id="2177" href="Prelude.Generics.Debug.html#2298" class="Function">genSimpleInstance</a> <a id="2195" href="Prelude.Tactics.Collect.html#2132" class="Bound">n′</a>
    <a id="2202" class="Symbol">(</a><a id="2203" class="Keyword">quote</a> <a id="2209" href="Prelude.Tactics.Collect.html#1948" class="Record">Collectible</a> <a id="2221" href="Prelude.Generics.Core.html#1771" class="InductiveConstructor Operator">∙⟦</a> <a id="2224" href="Prelude.Tactics.Collect.html#2143" class="Bound">ty</a> <a id="2227" href="Prelude.Generics.Core.html#1771" class="InductiveConstructor Operator">⟧</a><a id="2228" class="Symbol">)</a>
    <a id="2234" class="Symbol">(</a><a id="2235" class="Keyword">quote</a> <a id="2241" href="Prelude.Tactics.Collect.html#1998" class="InductiveConstructor Operator">give_</a> <a id="2247" href="Prelude.Generics.Core.html#2034" class="InductiveConstructor Operator">◆⟦</a> <a id="2250" href="Prelude.Tactics.Collect.html#2160" class="Bound">`n</a> <a id="2253" href="Prelude.Generics.Core.html#2034" class="InductiveConstructor Operator">⟧</a><a id="2254" class="Symbol">)</a>

<a id="collectBase"></a><a id="2257" href="Prelude.Tactics.Collect.html#2257" class="Function">collectBase</a> <a id="2269" class="Symbol">:</a> <a id="2271" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a> <a id="2276" class="Symbol">→</a> <a id="2278" href="Agda.Builtin.Reflection.html#8279" class="Postulate">TC</a> <a id="2281" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
<a id="2286" href="Prelude.Tactics.Collect.html#2257" class="Function">collectBase</a> <a id="2298" href="Prelude.Tactics.Collect.html#2298" class="Bound">goal</a> <a id="2303" class="Symbol">=</a> <a id="2305" class="Keyword">do</a>
  <a id="2310" href="Prelude.Generics.Debug.html#768" class="Function">print</a> <a id="2316" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2318" class="String">&quot;Retrieving collections for: &quot;</a> <a id="2349" href="Prelude.Semigroup.html#251" class="Field Operator">◇</a> <a id="2351" href="Prelude.Show.html#351" class="Field">show</a> <a id="2356" href="Prelude.Tactics.Collect.html#2298" class="Bound">goal</a>
  <a id="2363" class="Symbol">(</a><a id="2364" href="Agda.Builtin.Reflection.html#5221" class="InductiveConstructor">meta</a> <a id="2369" href="Prelude.Tactics.Collect.html#2369" class="Bound">m</a> <a id="2371" class="Symbol">_)</a> <a id="2374" href="Prelude.Monad.html#590" class="Field Operator">←</a> <a id="2376" href="Reflection.TypeChecking.Monad.html#1221" class="Function">newMeta</a> <a id="2384" class="Symbol">(</a><a id="2385" class="Keyword">quote</a> <a id="2391" href="Prelude.Tactics.Collect.html#1948" class="Record">Collectible</a> <a id="2403" href="Prelude.Generics.Core.html#1771" class="InductiveConstructor Operator">∙⟦</a> <a id="2406" href="Prelude.Tactics.Collect.html#2298" class="Bound">goal</a> <a id="2411" href="Prelude.Generics.Core.html#1771" class="InductiveConstructor Operator">⟧</a><a id="2412" class="Symbol">)</a>
    <a id="2418" class="Keyword">where</a> <a id="2424" class="CatchallClause Symbol">_</a> <a id="2426" class="Symbol">→</a> <a id="2428" href="Prelude.Generics.Debug.html#586" class="Function Operator">_IMPOSSIBLE_</a>
  <a id="2443" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="2448" href="Prelude.Tactics.Collect.html#2448" class="Bound">f</a> <a id="2450" href="Prelude.Monad.html#590" class="Field Operator">←</a> <a id="2452" href="Data.List.Base.html#7070" class="Function">L.head</a> <a id="2459" href="Prelude.Functor.html#382" class="Field Operator">&lt;$&gt;</a> <a id="2463" href="Agda.Builtin.Reflection.html#11007" class="Postulate">getInstances</a> <a id="2476" href="Prelude.Tactics.Collect.html#2369" class="Bound">m</a>
    <a id="2482" class="Keyword">where</a> <a id="2488" class="CatchallClause Symbol">_</a> <a id="2490" class="Symbol">→</a> <a id="2492" href="Prelude.Generics.Debug.html#530" class="Function">error</a> <a id="2498" class="String">&quot;no implementation found&quot;</a>
  <a id="2526" href="Prelude.Generics.Debug.html#768" class="Function">print</a> <a id="2532" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2534" class="String">&quot;Found collectible implementation : &quot;</a> <a id="2572" href="Prelude.Semigroup.html#251" class="Field Operator">◇</a> <a id="2574" href="Prelude.Show.html#351" class="Field">show</a> <a id="2579" href="Prelude.Tactics.Collect.html#2448" class="Bound">f</a>
  <a id="2583" href="Prelude.Tactics.Collect.html#2583" class="Bound">n</a> <a id="2585" href="Prelude.Monad.html#590" class="Field Operator">←</a> <a id="2587" href="Agda.Builtin.Reflection.html#8819" class="Postulate">unquoteTC</a> <a id="2597" class="Symbol">{</a><a id="2598" class="Argument">A</a> <a id="2600" class="Symbol">=</a> <a id="2602" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="2606" class="Symbol">}</a> <a id="2608" class="Symbol">(</a><a id="2609" href="Agda.Builtin.Reflection.html#4928" class="InductiveConstructor">def</a> <a id="2613" class="Symbol">(</a><a id="2614" class="Keyword">quote</a> <a id="2620" href="Prelude.Tactics.Collect.html#2014" class="Field">collectName</a><a id="2631" class="Symbol">)</a> <a id="2633" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="2635" href="Reflection.Argument.html#1342" class="InductiveConstructor">iArg</a> <a id="2640" href="Prelude.Tactics.Collect.html#2448" class="Bound">f</a> <a id="2642" href="Data.List.Base.html#5034" class="Function Operator">]</a><a id="2643" class="Symbol">)</a>
  <a id="2647" href="Prelude.Monad.html#569" class="Field">return</a> <a id="2654" class="Symbol">(</a><a id="2655" href="Prelude.Tactics.Collect.html#2583" class="Bound">n</a> <a id="2657" href="Prelude.Generics.Core.html#1747" class="InductiveConstructor Operator">∙</a><a id="2658" class="Symbol">)</a>

<a id="2661" class="Keyword">record</a> <a id="ToTerm"></a><a id="2668" href="Prelude.Tactics.Collect.html#2668" class="Record">ToTerm</a> <a id="2675" class="Symbol">(</a><a id="2676" href="Prelude.Tactics.Collect.html#2676" class="Bound">A</a> <a id="2678" class="Symbol">:</a> <a id="2680" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="2684" href="Prelude.Init.html#261" class="Generalizable">ℓ</a><a id="2685" class="Symbol">)</a> <a id="2687" class="Symbol">:</a> <a id="2689" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="2693" href="Prelude.Tactics.Collect.html#2684" class="Bound">ℓ</a> <a id="2695" class="Keyword">where</a>
  <a id="2703" class="Keyword">field</a> <a id="ToTerm.toTerm"></a><a id="2709" href="Prelude.Tactics.Collect.html#2709" class="Field">toTerm</a> <a id="2716" class="Symbol">:</a> <a id="2718" href="Prelude.Tactics.Collect.html#2676" class="Bound">A</a> <a id="2720" class="Symbol">→</a> <a id="2722" href="Agda.Builtin.Reflection.html#8279" class="Postulate">TC</a> <a id="2725" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
<a id="2730" class="Keyword">open</a> <a id="2735" href="Prelude.Tactics.Collect.html#2668" class="Module">ToTerm</a> <a id="2742" class="Symbol">⦃...⦄</a>
<a id="2748" class="Keyword">instance</a>
  <a id="ToTerm-Term"></a><a id="2759" href="Prelude.Tactics.Collect.html#2759" class="Function">ToTerm-Term</a> <a id="2771" class="Symbol">:</a> <a id="2773" href="Prelude.Tactics.Collect.html#2668" class="Record">ToTerm</a> <a id="2780" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
  <a id="2787" href="Prelude.Tactics.Collect.html#2759" class="Function">ToTerm-Term</a> <a id="2799" class="Symbol">.</a><a id="2800" href="Prelude.Tactics.Collect.html#2709" class="Field">toTerm</a> <a id="2807" class="Symbol">=</a> <a id="2809" href="Prelude.Monad.html#569" class="Field">return</a>

  <a id="ToTerm-Name"></a><a id="2819" href="Prelude.Tactics.Collect.html#2819" class="Function">ToTerm-Name</a> <a id="2831" class="Symbol">:</a> <a id="2833" href="Prelude.Tactics.Collect.html#2668" class="Record">ToTerm</a> <a id="2840" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a>
  <a id="2847" href="Prelude.Tactics.Collect.html#2819" class="Function">ToTerm-Name</a> <a id="2859" class="Symbol">.</a><a id="2860" href="Prelude.Tactics.Collect.html#2709" class="Field">toTerm</a> <a id="2867" href="Prelude.Tactics.Collect.html#2867" class="Bound">n</a> <a id="2869" class="Symbol">=</a> <a id="2871" href="Prelude.Monad.html#569" class="Field">return</a> <a id="2878" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2880" href="Agda.Builtin.Reflection.html#4928" class="InductiveConstructor">def</a> <a id="2884" href="Prelude.Tactics.Collect.html#2867" class="Bound">n</a> <a id="2886" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>

  <a id="ToTerm-Set"></a><a id="2892" href="Prelude.Tactics.Collect.html#2892" class="Function">ToTerm-Set</a> <a id="2903" class="Symbol">:</a> <a id="2905" href="Prelude.Tactics.Collect.html#2668" class="Record">ToTerm</a> <a id="2912" class="Symbol">(</a><a id="2913" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="2917" href="Prelude.Init.html#261" class="Generalizable">ℓ</a><a id="2918" class="Symbol">)</a>
  <a id="2922" href="Prelude.Tactics.Collect.html#2892" class="Function">ToTerm-Set</a> <a id="2933" class="Symbol">.</a><a id="2934" href="Prelude.Tactics.Collect.html#2709" class="Field">toTerm</a> <a id="2941" class="Symbol">=</a> <a id="2943" href="Agda.Builtin.Reflection.html#8766" class="Postulate">quoteTC</a>

<a id="collectSource"></a><a id="2952" href="Prelude.Tactics.Collect.html#2952" class="Function">collectSource</a> <a id="2966" class="Symbol">:</a> <a id="2968" class="Symbol">{</a><a id="2969" href="Prelude.Tactics.Collect.html#2969" class="Bound">A</a> <a id="2971" class="Symbol">:</a> <a id="2973" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="2977" href="Prelude.Init.html#261" class="Generalizable">ℓ</a><a id="2978" class="Symbol">}</a> <a id="2980" class="Symbol">→</a> <a id="2982" class="Symbol">⦃</a> <a id="2984" href="Prelude.Tactics.Collect.html#2668" class="Record">ToTerm</a> <a id="2991" href="Prelude.Tactics.Collect.html#2969" class="Bound">A</a> <a id="2993" class="Symbol">⦄</a> <a id="2995" class="Symbol">→</a> <a id="2997" href="Prelude.Tactics.Collect.html#2969" class="Bound">A</a> <a id="2999" class="Symbol">→</a> <a id="3001" href="Prelude.Generics.Core.html#2386" class="Function">Tactic</a>
<a id="3008" href="Prelude.Tactics.Collect.html#2952" class="Function">collectSource</a> <a id="3022" href="Prelude.Tactics.Collect.html#3022" class="Bound">As</a> <a id="3025" href="Prelude.Tactics.Collect.html#3025" class="Bound">hole</a> <a id="3030" class="Symbol">=</a> <a id="3032" class="Keyword">do</a>
  <a id="3037" href="Prelude.Tactics.Collect.html#3037" class="Bound">As</a> <a id="3040" href="Prelude.Monad.html#590" class="Field Operator">←</a> <a id="3042" href="Prelude.Tactics.Collect.html#2709" class="Field">toTerm</a> <a id="3049" href="Prelude.Tactics.Collect.html#3022" class="Bound">As</a>
  <a id="3054" class="Symbol">(</a><a id="3055" href="Prelude.Tactics.Collect.html#3055" class="Bound">X</a> <a id="3057" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3059" class="Symbol">_)</a> <a id="3062" href="Prelude.Monad.html#590" class="Field Operator">←</a> <a id="3064" href="Prelude.Generics.Core.html#3034" class="Function">vArgs</a> <a id="3070" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3072" href="Prelude.Generics.Utils.html#1522" class="Function">argTys</a> <a id="3079" href="Prelude.Functor.html#382" class="Field Operator">&lt;$&gt;</a> <a id="3083" href="Agda.Builtin.Reflection.html#8555" class="Postulate">inferType</a> <a id="3093" href="Prelude.Tactics.Collect.html#3025" class="Bound">hole</a>
    <a id="3102" class="Keyword">where</a> <a id="3108" class="CatchallClause Symbol">_</a> <a id="3110" class="Symbol">→</a> <a id="3112" href="Prelude.Generics.Debug.html#530" class="Function">error</a> <a id="3118" class="String">&quot;expected goal of the form: X → As&quot;</a>
  <a id="3156" href="Agda.Builtin.Reflection.html#8452" class="Postulate">unify</a> <a id="3162" href="Prelude.Tactics.Collect.html#3025" class="Bound">hole</a> <a id="3167" href="Prelude.Monad.html#679" class="Function Operator">=&lt;&lt;</a> <a id="3171" href="Prelude.Tactics.Collect.html#2257" class="Function">collectBase</a> <a id="3183" class="Symbol">(</a><a id="3184" href="Reflection.Term.html#1897" class="InductiveConstructor Operator">vΠ[</a> <a id="3188" class="String">&quot;_&quot;</a> <a id="3192" href="Reflection.Term.html#1897" class="InductiveConstructor Operator">∶</a> <a id="3194" href="Prelude.Tactics.Collect.html#3055" class="Bound">X</a> <a id="3196" href="Reflection.Term.html#1897" class="InductiveConstructor Operator">]</a> <a id="3198" href="Prelude.Tactics.Collect.html#3037" class="Bound">As</a><a id="3200" class="Symbol">)</a>

<a id="_∘collectSource_"></a><a id="3203" href="Prelude.Tactics.Collect.html#3203" class="Function Operator">_∘collectSource_</a> <a id="3220" class="Symbol">:</a> <a id="3222" class="Symbol">{</a><a id="3223" href="Prelude.Tactics.Collect.html#3223" class="Bound">P</a> <a id="3225" class="Symbol">:</a> <a id="3227" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="3231" href="Prelude.Init.html#261" class="Generalizable">ℓ</a><a id="3232" class="Symbol">}</a> <a id="3234" class="Symbol">{</a><a id="3235" href="Prelude.Tactics.Collect.html#3235" class="Bound">A</a> <a id="3237" class="Symbol">:</a> <a id="3239" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="3243" href="Prelude.Init.html#263" class="Generalizable">ℓ′</a><a id="3245" class="Symbol">}</a> <a id="3247" class="Symbol">→</a> <a id="3249" class="Symbol">⦃</a> <a id="3251" href="Prelude.Tactics.Collect.html#2668" class="Record">ToTerm</a> <a id="3258" href="Prelude.Tactics.Collect.html#3223" class="Bound">P</a> <a id="3260" class="Symbol">⦄</a> <a id="3262" class="Symbol">→</a> <a id="3264" class="Symbol">⦃</a> <a id="3266" href="Prelude.Tactics.Collect.html#2668" class="Record">ToTerm</a> <a id="3273" href="Prelude.Tactics.Collect.html#3235" class="Bound">A</a> <a id="3275" class="Symbol">⦄</a>
  <a id="3279" class="Symbol">→</a> <a id="3281" href="Prelude.Tactics.Collect.html#3223" class="Bound">P</a> <a id="3283" class="Symbol">→</a> <a id="3285" href="Prelude.Tactics.Collect.html#3235" class="Bound">A</a> <a id="3287" class="Symbol">→</a> <a id="3289" href="Prelude.Generics.Core.html#2386" class="Function">Tactic</a>
<a id="3296" class="Symbol">(</a><a id="3297" href="Prelude.Tactics.Collect.html#3297" class="Bound">f</a> <a id="3299" href="Prelude.Tactics.Collect.html#3203" class="Function Operator">∘collectSource</a> <a id="3314" href="Prelude.Tactics.Collect.html#3314" class="Bound">As</a><a id="3316" class="Symbol">)</a> <a id="3318" href="Prelude.Tactics.Collect.html#3318" class="Bound">hole</a> <a id="3323" class="Symbol">=</a> <a id="3325" class="Keyword">do</a>
  <a id="3330" href="Prelude.Tactics.Collect.html#3330" class="Bound">As</a> <a id="3333" href="Prelude.Monad.html#590" class="Field Operator">←</a> <a id="3335" href="Prelude.Tactics.Collect.html#2709" class="Field">toTerm</a> <a id="3342" href="Prelude.Tactics.Collect.html#3314" class="Bound">As</a>
  <a id="3347" href="Prelude.Tactics.Collect.html#3347" class="Bound">f</a> <a id="3349" href="Prelude.Monad.html#590" class="Field Operator">←</a> <a id="3351" href="Prelude.Tactics.Collect.html#2709" class="Field">toTerm</a> <a id="3358" href="Prelude.Tactics.Collect.html#3297" class="Bound">f</a>
  <a id="3362" class="Symbol">(</a><a id="3363" href="Prelude.Tactics.Collect.html#3363" class="Bound">X</a> <a id="3365" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3367" class="Symbol">_)</a> <a id="3370" href="Prelude.Monad.html#590" class="Field Operator">←</a> <a id="3372" href="Prelude.Generics.Core.html#3034" class="Function">vArgs</a> <a id="3378" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3380" href="Prelude.Generics.Utils.html#1522" class="Function">argTys</a> <a id="3387" href="Prelude.Functor.html#382" class="Field Operator">&lt;$&gt;</a> <a id="3391" href="Agda.Builtin.Reflection.html#8555" class="Postulate">inferType</a> <a id="3401" href="Prelude.Tactics.Collect.html#3318" class="Bound">hole</a>
    <a id="3410" class="Keyword">where</a> <a id="3416" class="CatchallClause Symbol">_</a> <a id="3418" class="Symbol">→</a> <a id="3420" href="Prelude.Generics.Debug.html#530" class="Function">error</a> <a id="3426" class="String">&quot;expected goal of the form: X → As&quot;</a>
  <a id="3464" href="Prelude.Tactics.Collect.html#3464" class="Bound">t</a> <a id="3466" href="Prelude.Monad.html#590" class="Field Operator">←</a> <a id="3468" href="Prelude.Tactics.Collect.html#2257" class="Function">collectBase</a> <a id="3480" class="Symbol">(</a><a id="3481" href="Reflection.Term.html#1897" class="InductiveConstructor Operator">vΠ[</a> <a id="3485" class="String">&quot;_&quot;</a> <a id="3489" href="Reflection.Term.html#1897" class="InductiveConstructor Operator">∶</a> <a id="3491" href="Prelude.Tactics.Collect.html#3363" class="Bound">X</a> <a id="3493" href="Reflection.Term.html#1897" class="InductiveConstructor Operator">]</a> <a id="3495" href="Prelude.Tactics.Collect.html#3330" class="Bound">As</a><a id="3497" class="Symbol">)</a>
  <a id="3501" href="Agda.Builtin.Reflection.html#8452" class="Postulate">unify</a> <a id="3507" href="Prelude.Tactics.Collect.html#3318" class="Bound">hole</a> <a id="3512" class="Symbol">(</a><a id="3513" class="Keyword">quote</a> <a id="3519" href="Function.Base.html#1040" class="Function Operator">_∘_</a> <a id="3523" href="Prelude.Generics.Core.html#1811" class="InductiveConstructor Operator">∙⟦</a> <a id="3526" href="Prelude.Tactics.Collect.html#3347" class="Bound">f</a> <a id="3528" href="Prelude.Generics.Core.html#1811" class="InductiveConstructor Operator">∣</a> <a id="3530" href="Prelude.Tactics.Collect.html#3464" class="Bound">t</a> <a id="3532" href="Prelude.Generics.Core.html#1811" class="InductiveConstructor Operator">⟧</a><a id="3533" class="Symbol">)</a>

<a id="3536" class="Keyword">macro</a> <a id="collectI"></a><a id="3542" href="Prelude.Tactics.Collect.html#3542" class="Function">collectI</a> <a id="3551" class="Symbol">=</a> <a id="3553" class="Symbol">λ</a> <a id="3555" href="Prelude.Tactics.Collect.html#3555" class="Bound">hole</a> <a id="3560" class="Symbol">→</a> <a id="3562" href="Agda.Builtin.Reflection.html#8452" class="Postulate">unify</a> <a id="3568" href="Prelude.Tactics.Collect.html#3555" class="Bound">hole</a> <a id="3573" href="Prelude.Monad.html#679" class="Function Operator">=&lt;&lt;</a> <a id="3577" href="Prelude.Tactics.Collect.html#2257" class="Function">collectBase</a> <a id="3589" href="Prelude.Monad.html#679" class="Function Operator">=&lt;&lt;</a> <a id="3593" href="Agda.Builtin.Reflection.html#8555" class="Postulate">inferType</a> <a id="3603" href="Prelude.Tactics.Collect.html#3555" class="Bound">hole</a>

<a id="3609" class="Keyword">private</a>
  <a id="3619" class="Comment">-- instance</a>
  <a id="3633" class="Comment">--   collect-f = Collectible (ℕ → List ℤ)  ∋ give quote f</a>
  <a id="3693" class="Comment">--   collect-g = Collectible (ℕ → Vec ℤ 1) ∋ give quote g</a>
  <a id="3753" class="Keyword">unquoteDecl</a> <a id="collect-f"></a><a id="3765" href="Prelude.Tactics.Collect.html#3765" class="Function">collect-f</a> <a id="collect-g"></a><a id="3775" href="Prelude.Tactics.Collect.html#3775" class="Function">collect-g</a> <a id="collect-fs"></a><a id="3785" href="Prelude.Tactics.Collect.html#3785" class="Function">collect-fs</a> <a id="3796" class="Symbol">=</a> <a id="3798" href="Prelude.Tactics.Collect.html#2059" class="Function">REGISTER</a>
    <a id="3811" class="Symbol">(</a> <a id="3813" class="Symbol">(</a><a id="3814" class="Keyword">quote</a> <a id="3820" href="Prelude.Tactics.Collect.html#1330" class="Function">f</a> <a id="3822" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3824" href="Prelude.Tactics.Collect.html#3765" class="Function">collect-f</a><a id="3833" class="Symbol">)</a>
    <a id="3839" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3841" class="Symbol">(</a><a id="3842" class="Keyword">quote</a> <a id="3848" href="Prelude.Tactics.Collect.html#1363" class="Function">g</a> <a id="3850" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3852" href="Prelude.Tactics.Collect.html#3775" class="Function">collect-g</a><a id="3861" class="Symbol">)</a>
    <a id="3867" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3869" class="Symbol">(</a><a id="3870" class="Keyword">quote</a> <a id="3876" href="Prelude.Tactics.Collect.html#1399" class="Function">fs</a> <a id="3879" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3881" href="Prelude.Tactics.Collect.html#3785" class="Function">collect-fs</a><a id="3891" class="Symbol">)</a>
    <a id="3897" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3899" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>
    <a id="3906" class="Symbol">)</a>

  <a id="3911" class="Comment">-- DOES NOT WORK: thinks we&#39;re expecting List to the right of _≡_</a>
  <a id="3979" class="Comment">-- _ = collectI 5 ≡ V.[ + 5 ] ∋ refl</a>

  <a id="4019" href="Prelude.Tactics.Collect.html#4019" class="Function">_</a> <a id="4021" class="Symbol">=</a> <a id="4023" href="Data.Vec.Base.html#5759" class="Function Operator">V.[</a> <a id="4027" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="4029" class="Number">5</a> <a id="4031" href="Data.Vec.Base.html#5759" class="Function Operator">]</a> <a id="4033" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="4035" href="Prelude.Tactics.Collect.html#3542" class="Macro">collectI</a> <a id="4044" class="Number">5</a> <a id="4046" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="4048" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

  <a id="iex-f"></a><a id="4056" href="Prelude.Tactics.Collect.html#4056" class="Function">iex-f</a> <a id="4062" class="Symbol">:</a> <a id="4064" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="4066" class="Symbol">→</a> <a id="4068" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="4073" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a>
  <a id="4077" href="Prelude.Tactics.Collect.html#4056" class="Function">iex-f</a> <a id="4083" class="Symbol">=</a> <a id="4085" href="Prelude.Tactics.Collect.html#3542" class="Macro">collectI</a>
  <a id="4096" href="Prelude.Tactics.Collect.html#4096" class="Function">_</a> <a id="4098" class="Symbol">=</a> <a id="4100" href="Prelude.Tactics.Collect.html#4056" class="Function">iex-f</a> <a id="4106" class="Number">5</a> <a id="4108" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="4110" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="4112" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="4114" class="Number">5</a> <a id="4116" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="4118" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="4120" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

  <a id="iex-g"></a><a id="4128" href="Prelude.Tactics.Collect.html#4128" class="Function">iex-g</a> <a id="4134" class="Symbol">:</a> <a id="4136" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="4138" class="Symbol">→</a> <a id="4140" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a id="4144" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a> <a id="4146" class="Number">1</a>
  <a id="4150" href="Prelude.Tactics.Collect.html#4128" class="Function">iex-g</a> <a id="4156" class="Symbol">=</a> <a id="4158" href="Prelude.Tactics.Collect.html#3542" class="Macro">collectI</a>
  <a id="4169" href="Prelude.Tactics.Collect.html#4169" class="Function">_</a> <a id="4171" class="Symbol">=</a> <a id="4173" href="Prelude.Tactics.Collect.html#4128" class="Function">iex-g</a> <a id="4179" class="Number">5</a> <a id="4181" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="4183" href="Data.Vec.Base.html#5759" class="Function Operator">V.[</a> <a id="4187" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="4189" class="Number">5</a> <a id="4191" href="Data.Vec.Base.html#5759" class="Function Operator">]</a> <a id="4193" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="4195" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

  <a id="iex-fs"></a><a id="4203" href="Prelude.Tactics.Collect.html#4203" class="Function">iex-fs</a> <a id="4210" class="Symbol">:</a> <a id="4212" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="4219" class="Symbol">→</a> <a id="4221" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="4226" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a>
  <a id="4230" href="Prelude.Tactics.Collect.html#4203" class="Function">iex-fs</a> <a id="4237" class="Symbol">=</a> <a id="4239" href="Prelude.Tactics.Collect.html#920" class="Macro">collect</a>
  <a id="4249" href="Prelude.Tactics.Collect.html#4249" class="Function">_</a> <a id="4251" class="Symbol">=</a> <a id="4253" href="Prelude.Tactics.Collect.html#4203" class="Function">iex-fs</a> <a id="4260" class="String">&quot;sth&quot;</a> <a id="4266" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="4268" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="4270" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="4272" class="Number">0</a> <a id="4274" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="4276" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="4278" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

  <a id="4286" class="Keyword">macro</a> <a id="ints"></a><a id="4292" href="Prelude.Tactics.Collect.html#4292" class="Function">ints</a> <a id="4297" class="Symbol">=</a> <a id="4299" href="Prelude.Tactics.Collect.html#2952" class="Function">collectSource</a> <a id="4313" class="Symbol">(</a><a id="4314" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="4319" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a><a id="4320" class="Symbol">)</a>
        <a id="nats"></a><a id="4330" href="Prelude.Tactics.Collect.html#4330" class="Function">nats</a> <a id="4335" class="Symbol">=</a> <a id="4337" class="Keyword">quote</a> <a id="4343" href="Prelude.Tactics.Collect.html#4393" class="Function">ints→nats</a> <a id="4353" href="Prelude.Tactics.Collect.html#3203" class="Function Operator">∘collectSource</a> <a id="4368" class="Symbol">(</a><a id="4369" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="4374" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a><a id="4375" class="Symbol">)</a>
          <a id="4387" class="Keyword">where</a> <a id="4393" href="Prelude.Tactics.Collect.html#4393" class="Function">ints→nats</a> <a id="4403" class="Symbol">=</a> <a id="4405" href="Data.List.Base.html#1553" class="Function">map</a> <a id="4409" class="Symbol">{</a><a id="4410" class="Argument">A</a> <a id="4412" class="Symbol">=</a> <a id="4414" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a><a id="4415" class="Symbol">}</a> <a id="4417" class="Symbol">(</a><a id="4418" href="Function.Base.html#645" class="Function">const</a> <a id="4424" class="Number">42</a><a id="4426" class="Symbol">)</a>

  <a id="z-f"></a><a id="4431" href="Prelude.Tactics.Collect.html#4431" class="Function">z-f</a> <a id="4435" class="Symbol">:</a> <a id="4437" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="4439" class="Symbol">→</a> <a id="4441" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="4446" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a>
  <a id="4450" href="Prelude.Tactics.Collect.html#4431" class="Function">z-f</a> <a id="4454" class="Symbol">=</a> <a id="4456" href="Prelude.Tactics.Collect.html#4292" class="Macro">ints</a>
  <a id="4463" href="Prelude.Tactics.Collect.html#4463" class="Function">_</a> <a id="4465" class="Symbol">=</a> <a id="4467" href="Prelude.Tactics.Collect.html#4431" class="Function">z-f</a> <a id="4471" class="Number">0</a> <a id="4473" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="4475" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="4477" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="4479" class="Number">0</a> <a id="4481" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="4483" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="4485" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

  <a id="z-fs"></a><a id="4493" href="Prelude.Tactics.Collect.html#4493" class="Function">z-fs</a> <a id="4498" class="Symbol">:</a> <a id="4500" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="4507" class="Symbol">→</a> <a id="4509" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="4514" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a>
  <a id="4518" href="Prelude.Tactics.Collect.html#4493" class="Function">z-fs</a> <a id="4523" class="Symbol">=</a> <a id="4525" href="Prelude.Tactics.Collect.html#4292" class="Macro">ints</a>
  <a id="4532" href="Prelude.Tactics.Collect.html#4532" class="Function">_</a> <a id="4534" class="Symbol">=</a> <a id="4536" href="Prelude.Tactics.Collect.html#4493" class="Function">z-fs</a> <a id="4541" class="String">&quot;sth&quot;</a> <a id="4547" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="4549" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="4551" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="4553" class="Number">0</a> <a id="4555" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="4557" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="4559" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

  <a id="n-fs"></a><a id="4567" href="Prelude.Tactics.Collect.html#4567" class="Function">n-fs</a> <a id="4572" class="Symbol">:</a> <a id="4574" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="4581" class="Symbol">→</a> <a id="4583" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="4588" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
  <a id="4592" href="Prelude.Tactics.Collect.html#4567" class="Function">n-fs</a> <a id="4597" class="Symbol">=</a> <a id="4599" href="Prelude.Tactics.Collect.html#4330" class="Macro">nats</a>
  <a id="4606" href="Prelude.Tactics.Collect.html#4606" class="Function">_</a> <a id="4608" class="Symbol">=</a> <a id="4610" href="Prelude.Tactics.Collect.html#4567" class="Function">n-fs</a> <a id="4615" class="String">&quot;sth&quot;</a> <a id="4621" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="4623" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="4625" class="Number">42</a> <a id="4628" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="4630" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="4632" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
</pre></body></html>