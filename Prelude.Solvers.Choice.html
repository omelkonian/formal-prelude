<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Prelude.Solvers.Choice</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/formal-prelude/tree/master/Prelude/Solvers/Choice.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--with-K</a> <a id="22" class="Symbol">#-}</a>
<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="51" class="Keyword">open</a> <a id="56" class="Keyword">import</a> <a id="63" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="77" class="Keyword">open</a> <a id="82" class="Keyword">import</a> <a id="89" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="105" class="Keyword">open</a> <a id="110" class="Keyword">import</a> <a id="117" href="Prelude.Bifunctor.html" class="Module">Prelude.Bifunctor</a>
<a id="135" class="Keyword">open</a> <a id="140" class="Keyword">import</a> <a id="147" href="Prelude.Semigroup.html" class="Module">Prelude.Semigroup</a>
<a id="165" class="Keyword">open</a> <a id="170" class="Keyword">import</a> <a id="177" href="Prelude.Applicative.html" class="Module">Prelude.Applicative</a>
<a id="197" class="Keyword">open</a> <a id="202" class="Keyword">import</a> <a id="209" href="Prelude.Monad.html" class="Module">Prelude.Monad</a>
<a id="223" class="Keyword">open</a> <a id="228" class="Keyword">import</a> <a id="235" href="Prelude.Show.html" class="Module">Prelude.Show</a>
<a id="248" class="Keyword">open</a> <a id="253" class="Keyword">import</a> <a id="260" href="Prelude.Nary.html" class="Module">Prelude.Nary</a>
<a id="273" class="Keyword">open</a> <a id="278" class="Keyword">import</a> <a id="285" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="299" class="Keyword">open</a> <a id="304" class="Keyword">import</a> <a id="311" href="Prelude.ToN.html" class="Module">Prelude.ToN</a>

<a id="324" class="Keyword">open</a> <a id="329" class="Keyword">import</a> <a id="336" href="Prelude.Generics.html" class="Module">Prelude.Generics</a>
<a id="353" class="Keyword">open</a> <a id="358" href="Prelude.Init.html#12638" class="Module">Meta</a>
<a id="363" class="Keyword">open</a> <a id="368" href="Prelude.Generics.Debug.html#648" class="Module">Debug</a> <a id="374" class="Symbol">(</a><a id="375" class="String">&quot;Generics.Solvers.Any&quot;</a> <a id="398" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="400" class="Number">100</a><a id="403" class="Symbol">)</a>

<a id="406" class="Keyword">open</a> <a id="411" class="Keyword">import</a> <a id="418" href="Prelude.Solvers.Base.html" class="Module">Prelude.Solvers.Base</a>

<a id="440" class="Keyword">module</a> <a id="447" href="Prelude.Solvers.Choice.html" class="Module">Prelude.Solvers.Choice</a>
  <a id="472" class="Symbol">(</a><a id="473" href="Prelude.Solvers.Choice.html#473" class="Bound">newGoal</a> <a id="481" class="Symbol">:</a> <a id="483" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a> <a id="488" class="Symbol">→</a> <a id="490" href="Agda.Builtin.Reflection.html#8279" class="Postulate">TC</a> <a id="493" href="Prelude.Generics.Core.html#2353" class="Function">Hole</a><a id="497" class="Symbol">)</a>
  <a id="501" class="Symbol">(</a><a id="502" href="Prelude.Solvers.Choice.html#502" class="Bound Operator">_:=_∋_</a> <a id="509" class="Symbol">:</a> <a id="511" href="Prelude.Generics.Core.html#2366" class="Function">THole</a> <a id="517" class="Symbol">→</a> <a id="519" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a> <a id="524" class="Symbol">→</a> <a id="526" href="Prelude.Solvers.Base.html#1095" class="Function">TermCtx</a> <a id="534" class="Symbol">→</a> <a id="536" href="Agda.Builtin.Reflection.html#8279" class="Postulate">TC</a> <a id="539" href="Agda.Builtin.Unit.html#158" class="Record">⊤</a><a id="540" class="Symbol">)</a>
  <a id="544" class="Symbol">(</a><a id="545" href="Prelude.Solvers.Choice.html#545" class="Bound Operator">_:=_∣_∋_</a> <a id="554" class="Symbol">:</a> <a id="556" href="Prelude.Generics.Core.html#2366" class="Function">THole</a> <a id="562" class="Symbol">→</a> <a id="564" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a> <a id="569" class="Symbol">→</a> <a id="571" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a> <a id="576" class="Symbol">→</a> <a id="578" href="Prelude.Solvers.Base.html#1401" class="Function">TermCtx²</a> <a id="587" class="Symbol">→</a> <a id="589" href="Agda.Builtin.Reflection.html#8279" class="Postulate">TC</a> <a id="592" href="Agda.Builtin.Unit.html#158" class="Record">⊤</a><a id="593" class="Symbol">)</a>
  <a id="597" class="Keyword">where</a>

<a id="Choice"></a><a id="604" href="Prelude.Solvers.Choice.html#604" class="Function">Choice</a> <a id="611" class="Symbol">=</a> <a id="613" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="615" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="617" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="624" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="626" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a> <a id="631" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="633" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a>
<a id="Choices"></a><a id="638" href="Prelude.Solvers.Choice.html#638" class="Function">Choices</a> <a id="646" class="Symbol">=</a> <a id="648" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="653" href="Prelude.Solvers.Choice.html#604" class="Function">Choice</a>

<a id="toSum"></a><a id="661" href="Prelude.Solvers.Choice.html#661" class="Function">toSum</a> <a id="667" class="Symbol">:</a> <a id="669" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a> <a id="674" class="Symbol">→</a> <a id="676" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="682" class="Symbol">(</a><a id="683" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a> <a id="688" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="690" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a><a id="694" class="Symbol">)</a>
<a id="696" href="Prelude.Solvers.Choice.html#661" class="Function">toSum</a> <a id="702" class="Symbol">=</a> <a id="704" class="Symbol">λ</a> <a id="706" class="Keyword">where</a>
  <a id="714" class="Symbol">(</a><a id="715" href="Agda.Builtin.Reflection.html#4928" class="InductiveConstructor">def</a> <a id="719" class="Symbol">(</a><a id="720" class="Keyword">quote</a> <a id="726" href="Data.Sum.Base.html#743" class="Datatype Operator">_⊎_</a><a id="729" class="Symbol">)</a> <a id="731" href="Prelude.Solvers.Choice.html#731" class="Bound">as</a><a id="733" class="Symbol">)</a> <a id="735" class="Symbol">→</a> <a id="737" href="Function.Base.html#4130" class="Function Operator">case</a> <a id="742" href="Prelude.Generics.Core.html#3034" class="Function">vArgs</a> <a id="748" href="Prelude.Solvers.Choice.html#731" class="Bound">as</a> <a id="751" href="Function.Base.html#4130" class="Function Operator">of</a> <a id="754" class="Symbol">λ</a> <a id="756" class="Keyword">where</a>
    <a id="766" class="Symbol">(</a><a id="767" href="Prelude.Solvers.Choice.html#767" class="Bound">A</a> <a id="769" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="771" href="Prelude.Solvers.Choice.html#771" class="Bound">B</a> <a id="773" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="775" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="777" class="Symbol">)</a> <a id="779" class="Symbol">→</a> <a id="781" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="786" class="Symbol">(</a><a id="787" href="Prelude.Solvers.Choice.html#767" class="Bound">A</a> <a id="789" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="791" href="Prelude.Solvers.Choice.html#771" class="Bound">B</a><a id="792" class="Symbol">)</a>
    <a id="798" class="CatchallClause Symbol">_</a> <a id="800" class="Symbol">→</a> <a id="802" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>
  <a id="812" class="CatchallClause Symbol">_</a> <a id="814" class="Symbol">→</a> <a id="816" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>

<a id="choicesFromContext"></a><a id="825" href="Prelude.Solvers.Choice.html#825" class="Function">choicesFromContext</a> <a id="844" class="Symbol">:</a> <a id="846" href="Agda.Builtin.Reflection.html#8279" class="Postulate">TC</a> <a id="849" href="Prelude.Solvers.Choice.html#638" class="Function">Choices</a>
<a id="857" href="Prelude.Solvers.Choice.html#825" class="Function">choicesFromContext</a>
  <a id="878" class="Symbol">=</a> <a id="880" href="Data.List.Base.html#1638" class="Function">mapMaybe</a> <a id="889" class="Symbol">(λ{</a> <a id="893" class="Symbol">(</a><a id="894" href="Prelude.Solvers.Choice.html#894" class="Bound">i</a> <a id="896" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="898" class="Symbol">(</a><a id="899" href="Prelude.Solvers.Choice.html#899" class="Bound">s</a> <a id="901" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="903" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="907" class="Symbol">_</a> <a id="909" href="Prelude.Solvers.Choice.html#909" class="Bound">ty</a><a id="911" class="Symbol">))</a> <a id="914" class="Symbol">→</a> <a id="916" class="Symbol">(λ</a> <a id="919" href="Prelude.Solvers.Choice.html#919" class="Bound">x</a> <a id="921" class="Symbol">→</a> <a id="923" href="Prelude.ToN.html#139" class="Field">toℕ</a> <a id="927" href="Prelude.Solvers.Choice.html#894" class="Bound">i</a> <a id="929" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="931" href="Prelude.Solvers.Choice.html#899" class="Bound">s</a> <a id="933" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="935" href="Prelude.Solvers.Choice.html#919" class="Bound">x</a><a id="936" class="Symbol">)</a> <a id="938" href="Prelude.Functor.html#382" class="Field Operator">&lt;$&gt;</a> <a id="942" href="Prelude.Solvers.Choice.html#661" class="Function">toSum</a> <a id="948" href="Prelude.Solvers.Choice.html#909" class="Bound">ty</a> <a id="951" class="Symbol">})</a>
  <a id="956" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="958" href="Prelude.Lists.Indexed.html#1518" class="Function">enumerate</a> <a id="968" href="Prelude.Functor.html#382" class="Field Operator">&lt;$&gt;</a> <a id="972" href="Agda.Builtin.Reflection.html#8920" class="Postulate">getContext</a>

<a id="984" class="Keyword">pattern</a> <a id="_`⇒_"></a><a id="992" href="Prelude.Solvers.Choice.html#992" class="InductiveConstructor Operator">_`⇒_</a> <a id="997" href="Prelude.Solvers.Choice.html#1013" class="Bound">A</a> <a id="999" href="Prelude.Solvers.Choice.html#1017" class="Bound">B</a> <a id="1001" class="Symbol">=</a> <a id="1003" href="Reflection.Term.html#1897" class="InductiveConstructor Operator">vΠ[</a> <a id="1007" class="String">&quot;_&quot;</a> <a id="1011" href="Reflection.Term.html#1897" class="InductiveConstructor Operator">∶</a> <a id="1013" href="Prelude.Solvers.Choice.html#1013" class="Bound">A</a> <a id="1015" href="Reflection.Term.html#1897" class="InductiveConstructor Operator">]</a> <a id="1017" href="Prelude.Solvers.Choice.html#1017" class="Bound">B</a>

<a id="choiceSolver"></a><a id="1020" href="Prelude.Solvers.Choice.html#1020" class="Function">choiceSolver</a> <a id="1033" class="Symbol">:</a> <a id="1035" href="Prelude.Solvers.Base.html#288" class="Record">Solver</a>
<a id="1042" href="Prelude.Solvers.Choice.html#1020" class="Function">choiceSolver</a> <a id="1055" class="Symbol">=</a> <a id="1057" class="Symbol">λ</a> <a id="1059" class="Keyword">where</a>
  <a id="1067" class="Symbol">.</a><a id="1068" href="Prelude.Solvers.Base.html#320" class="Field">View</a> <a id="1073" class="Symbol">→</a> <a id="1075" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
  <a id="1082" class="Symbol">.</a><a id="1083" href="Prelude.Solvers.Base.html#335" class="Field">view</a> <a id="1088" class="Symbol">→</a> <a id="1090" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a>
  <a id="1097" class="Symbol">.</a><a id="1098" href="Prelude.Solvers.Base.html#364" class="Field">solveView</a> <a id="1108" href="Prelude.Solvers.Choice.html#1108" class="Bound">thole</a><a id="1113" class="Symbol">@(_</a> <a id="1117" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1119" href="Prelude.Solvers.Choice.html#1119" class="Bound">ty</a><a id="1121" class="Symbol">)</a> <a id="1123" href="Prelude.Solvers.Choice.html#1123" class="Bound">t</a> <a id="1125" class="Symbol">→</a> <a id="1127" class="Keyword">do</a>
    <a id="1134" href="Prelude.Solvers.Choice.html#1134" class="Bound">choices</a> <a id="1142" href="Prelude.Monad.html#590" class="Field Operator">←</a> <a id="1144" href="Prelude.Solvers.Choice.html#825" class="Function">choicesFromContext</a>
    <a id="1167" href="Prelude.Generics.Debug.html#768" class="Function">print</a> <a id="1173" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1175" class="String">&quot;Choices: &quot;</a> <a id="1187" href="Prelude.Semigroup.html#251" class="Field Operator">◇</a> <a id="1189" href="Prelude.Show.html#351" class="Field">show</a> <a id="1194" href="Prelude.Solvers.Choice.html#1134" class="Bound">choices</a>
    <a id="1206" href="Prelude.Generics.Debug.html#1171" class="Function Operator">⋃∗</a> <a id="1209" href="Prelude.Solvers.Choice.html#1134" class="Bound">choices</a> <a id="1217" href="Prelude.Functor.html#477" class="Function Operator">&lt;&amp;&gt;</a> <a id="1221" class="Symbol">λ</a> <a id="1223" class="Symbol">(</a><a id="1224" href="Prelude.Solvers.Choice.html#1224" class="Bound">i</a> <a id="1226" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1228" href="Prelude.Solvers.Choice.html#1228" class="Bound">s</a> <a id="1230" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1232" href="Prelude.Solvers.Choice.html#1232" class="Bound">A</a> <a id="1234" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1236" href="Prelude.Solvers.Choice.html#1236" class="Bound">B</a><a id="1237" class="Symbol">)</a> <a id="1239" class="Symbol">→</a> <a id="1241" class="Keyword">do</a>
      <a id="1250" href="Prelude.Solvers.Choice.html#1250" class="Bound">ctx</a> <a id="1254" href="Prelude.Monad.html#590" class="Field Operator">←</a> <a id="1256" href="Agda.Builtin.Reflection.html#8920" class="Postulate">getContext</a>
      <a id="1273" href="Prelude.Solvers.Choice.html#1273" class="Bound">hA</a> <a id="1276" href="Prelude.Monad.html#590" class="Field Operator">←</a> <a id="1278" href="Agda.Builtin.Reflection.html#8954" class="Postulate">extendContext</a> <a id="1292" href="Prelude.Solvers.Choice.html#1228" class="Bound">s</a> <a id="1294" class="Symbol">(</a><a id="1295" href="Reflection.Argument.html#1218" class="InductiveConstructor">vArg</a> <a id="1300" href="Prelude.Solvers.Choice.html#1232" class="Bound">A</a><a id="1301" class="Symbol">)</a> <a id="1303" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1305" href="Prelude.Generics.Debug.html#768" class="Function">print</a> <a id="1311" class="String">&quot;LEFT: &quot;</a> <a id="1320" href="Prelude.Monad.html#624" class="Function Operator">&gt;&gt;</a> <a id="1323" href="Prelude.Solvers.Choice.html#473" class="Bound">newGoal</a> <a id="1331" href="Prelude.Solvers.Choice.html#1119" class="Bound">ty</a>
      <a id="1340" href="Prelude.Solvers.Choice.html#1340" class="Bound">hB</a> <a id="1343" href="Prelude.Monad.html#590" class="Field Operator">←</a> <a id="1345" href="Agda.Builtin.Reflection.html#8954" class="Postulate">extendContext</a> <a id="1359" href="Prelude.Solvers.Choice.html#1228" class="Bound">s</a> <a id="1361" class="Symbol">(</a><a id="1362" href="Reflection.Argument.html#1218" class="InductiveConstructor">vArg</a> <a id="1367" href="Prelude.Solvers.Choice.html#1236" class="Bound">B</a><a id="1368" class="Symbol">)</a> <a id="1370" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1372" href="Prelude.Generics.Debug.html#768" class="Function">print</a> <a id="1378" class="String">&quot;RIGHT: &quot;</a> <a id="1388" href="Prelude.Monad.html#624" class="Function Operator">&gt;&gt;</a> <a id="1391" href="Prelude.Solvers.Choice.html#473" class="Bound">newGoal</a> <a id="1399" href="Prelude.Solvers.Choice.html#1119" class="Bound">ty</a>
      <a id="1408" href="Prelude.Generics.Utils.html#10359" class="Function">unifyStrict</a> <a id="1420" href="Prelude.Solvers.Choice.html#1108" class="Bound">thole</a> <a id="1426" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1428" class="Keyword">quote</a> <a id="1434" href="Data.Sum.Base.html#1098" class="Function Operator">Sum.[_,_]′</a> <a id="1445" href="Prelude.Generics.Core.html#1864" class="InductiveConstructor Operator">∙⟦</a> <a id="1448" href="Prelude.Solvers.Choice.html#1273" class="Bound">hA</a> <a id="1451" href="Prelude.Generics.Core.html#1864" class="InductiveConstructor Operator">∣</a> <a id="1453" href="Prelude.Solvers.Choice.html#1340" class="Bound">hB</a> <a id="1456" href="Prelude.Generics.Core.html#1864" class="InductiveConstructor Operator">∣</a> <a id="1458" href="Prelude.Generics.Core.html#300" class="InductiveConstructor">♯</a> <a id="1460" href="Prelude.Solvers.Choice.html#1224" class="Bound">i</a> <a id="1462" href="Prelude.Generics.Core.html#1864" class="InductiveConstructor Operator">⟧</a>
      <a id="1470" class="Comment">-- thole := (A `⇒ C) ∣ (B `⇒ C) ∋ λ ◆ ◇ → quote Sum.[_,_]′ ∙⟦ ◆ ∣ ◇ ∣ ♯ i ⟧</a>
</pre></body></html>