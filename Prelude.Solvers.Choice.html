<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Prelude.Solvers.Choice</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/formal-prelude/tree/master/Prelude/Solvers/Choice.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="52" class="Keyword">open</a> <a id="57" class="Keyword">import</a> <a id="64" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="80" class="Keyword">open</a> <a id="85" class="Keyword">import</a> <a id="92" href="Prelude.Bifunctor.html" class="Module">Prelude.Bifunctor</a>
<a id="110" class="Keyword">open</a> <a id="115" class="Keyword">import</a> <a id="122" href="Prelude.Semigroup.html" class="Module">Prelude.Semigroup</a>
<a id="140" class="Keyword">open</a> <a id="145" class="Keyword">import</a> <a id="152" href="Prelude.Applicative.html" class="Module">Prelude.Applicative</a>
<a id="172" class="Keyword">open</a> <a id="177" class="Keyword">import</a> <a id="184" href="Prelude.Monad.html" class="Module">Prelude.Monad</a>
<a id="198" class="Keyword">open</a> <a id="203" class="Keyword">import</a> <a id="210" href="Prelude.Show.html" class="Module">Prelude.Show</a>
<a id="223" class="Keyword">open</a> <a id="228" class="Keyword">import</a> <a id="235" href="Prelude.Nary.html" class="Module">Prelude.Nary</a>
<a id="248" class="Keyword">open</a> <a id="253" class="Keyword">import</a> <a id="260" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="274" class="Keyword">open</a> <a id="279" class="Keyword">import</a> <a id="286" href="Prelude.ToN.html" class="Module">Prelude.ToN</a>

<a id="299" class="Keyword">open</a> <a id="304" class="Keyword">import</a> <a id="311" href="Prelude.Generics.html" class="Module">Prelude.Generics</a>
<a id="328" class="Keyword">open</a> <a id="333" href="Prelude.Init.html#12119" class="Module">Meta</a>
<a id="338" class="Keyword">open</a> <a id="343" href="Prelude.Generics.html#11367" class="Module">Debug</a> <a id="349" class="Symbol">(</a><a id="350" class="String">&quot;Generics.Solvers.Any&quot;</a> <a id="373" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="375" class="Number">100</a><a id="378" class="Symbol">)</a>

<a id="381" class="Keyword">open</a> <a id="386" class="Keyword">import</a> <a id="393" href="Prelude.Solvers.Base.html" class="Module">Prelude.Solvers.Base</a>

<a id="415" class="Keyword">module</a> <a id="422" href="Prelude.Solvers.Choice.html" class="Module">Prelude.Solvers.Choice</a>
  <a id="447" class="Symbol">(</a><a id="448" href="Prelude.Solvers.Choice.html#448" class="Bound">newGoal</a> <a id="456" class="Symbol">:</a> <a id="458" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a> <a id="463" class="Symbol">→</a> <a id="465" href="Agda.Builtin.Reflection.html#8218" class="Postulate">TC</a> <a id="468" href="Prelude.Generics.html#8903" class="Function">Hole</a><a id="472" class="Symbol">)</a>
  <a id="476" class="Symbol">(</a><a id="477" href="Prelude.Solvers.Choice.html#477" class="Bound Operator">_:=_∋_</a> <a id="484" class="Symbol">:</a> <a id="486" href="Prelude.Generics.html#8916" class="Function">THole</a> <a id="492" class="Symbol">→</a> <a id="494" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a> <a id="499" class="Symbol">→</a> <a id="501" href="Prelude.Solvers.Base.html#1080" class="Function">TermCtx</a> <a id="509" class="Symbol">→</a> <a id="511" href="Agda.Builtin.Reflection.html#8218" class="Postulate">TC</a> <a id="514" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a><a id="515" class="Symbol">)</a>
  <a id="519" class="Symbol">(</a><a id="520" href="Prelude.Solvers.Choice.html#520" class="Bound Operator">_:=_∣_∋_</a> <a id="529" class="Symbol">:</a> <a id="531" href="Prelude.Generics.html#8916" class="Function">THole</a> <a id="537" class="Symbol">→</a> <a id="539" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a> <a id="544" class="Symbol">→</a> <a id="546" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a> <a id="551" class="Symbol">→</a> <a id="553" href="Prelude.Solvers.Base.html#1386" class="Function">TermCtx²</a> <a id="562" class="Symbol">→</a> <a id="564" href="Agda.Builtin.Reflection.html#8218" class="Postulate">TC</a> <a id="567" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a><a id="568" class="Symbol">)</a>
  <a id="572" class="Keyword">where</a>

<a id="Choice"></a><a id="579" href="Prelude.Solvers.Choice.html#579" class="Function">Choice</a> <a id="586" class="Symbol">=</a> <a id="588" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="590" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="592" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a> <a id="597" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="599" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a>
<a id="Choices"></a><a id="604" href="Prelude.Solvers.Choice.html#604" class="Function">Choices</a> <a id="612" class="Symbol">=</a> <a id="614" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="619" href="Prelude.Solvers.Choice.html#579" class="Function">Choice</a>

<a id="toSum"></a><a id="627" href="Prelude.Solvers.Choice.html#627" class="Function">toSum</a> <a id="633" class="Symbol">:</a> <a id="635" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a> <a id="640" class="Symbol">→</a> <a id="642" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="648" class="Symbol">(</a><a id="649" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a> <a id="654" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="656" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a><a id="660" class="Symbol">)</a>
<a id="662" href="Prelude.Solvers.Choice.html#627" class="Function">toSum</a> <a id="668" class="Symbol">=</a> <a id="670" class="Symbol">λ</a> <a id="672" class="Keyword">where</a>
  <a id="680" class="Symbol">(</a><a id="681" href="Agda.Builtin.Reflection.html#4903" class="InductiveConstructor">def</a> <a id="685" class="Symbol">(</a><a id="686" class="Keyword">quote</a> <a id="692" href="Data.Sum.Base.html#734" class="Datatype Operator">_⊎_</a><a id="695" class="Symbol">)</a> <a id="697" href="Prelude.Solvers.Choice.html#697" class="Bound">as</a><a id="699" class="Symbol">)</a> <a id="701" class="Symbol">→</a> <a id="703" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="708" href="Prelude.Generics.html#8287" class="Function">vArgs</a> <a id="714" href="Prelude.Solvers.Choice.html#697" class="Bound">as</a> <a id="717" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="720" class="Symbol">λ</a> <a id="722" class="Keyword">where</a>
    <a id="732" class="Symbol">(</a><a id="733" href="Prelude.Solvers.Choice.html#733" class="Bound">A</a> <a id="735" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="737" href="Prelude.Solvers.Choice.html#737" class="Bound">B</a> <a id="739" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="741" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="743" class="Symbol">)</a> <a id="745" class="Symbol">→</a> <a id="747" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="752" class="Symbol">(</a><a id="753" href="Prelude.Solvers.Choice.html#733" class="Bound">A</a> <a id="755" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="757" href="Prelude.Solvers.Choice.html#737" class="Bound">B</a><a id="758" class="Symbol">)</a>
    <a id="764" class="CatchallClause Symbol">_</a> <a id="766" class="Symbol">→</a> <a id="768" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
  <a id="778" class="CatchallClause Symbol">_</a> <a id="780" class="Symbol">→</a> <a id="782" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>

<a id="choicesFromContext"></a><a id="791" href="Prelude.Solvers.Choice.html#791" class="Function">choicesFromContext</a> <a id="810" class="Symbol">:</a> <a id="812" href="Agda.Builtin.Reflection.html#8218" class="Postulate">TC</a> <a id="815" href="Prelude.Solvers.Choice.html#604" class="Function">Choices</a>
<a id="823" href="Prelude.Solvers.Choice.html#791" class="Function">choicesFromContext</a> <a id="842" class="Symbol">=</a> <a id="844" href="Data.List.Base.html#1629" class="Function">mapMaybe</a> <a id="853" class="Symbol">(λ{</a> <a id="857" class="Symbol">(</a><a id="858" href="Prelude.Solvers.Choice.html#858" class="Bound">i</a> <a id="860" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="862" href="Agda.Builtin.Reflection.html#3733" class="InductiveConstructor">arg</a> <a id="866" class="Symbol">_</a> <a id="868" href="Prelude.Solvers.Choice.html#868" class="Bound">ty</a><a id="870" class="Symbol">)</a> <a id="872" class="Symbol">→</a> <a id="874" class="Symbol">(</a><a id="875" href="Prelude.ToN.html#116" class="Field">toℕ</a> <a id="879" href="Prelude.Solvers.Choice.html#858" class="Bound">i</a> <a id="881" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,_</a><a id="883" class="Symbol">)</a> <a id="885" href="Prelude.Functor.html#359" class="Field Operator">&lt;$&gt;</a> <a id="889" href="Prelude.Solvers.Choice.html#627" class="Function">toSum</a> <a id="895" href="Prelude.Solvers.Choice.html#868" class="Bound">ty</a> <a id="898" class="Symbol">})</a> <a id="901" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="903" href="Prelude.Lists.Indexed.html#1495" class="Function">enumerate</a> <a id="913" href="Prelude.Functor.html#359" class="Field Operator">&lt;$&gt;</a> <a id="917" href="Agda.Builtin.Reflection.html#8859" class="Postulate">getContext</a>

<a id="929" class="Keyword">pattern</a> <a id="_`⇒_"></a><a id="937" href="Prelude.Solvers.Choice.html#937" class="InductiveConstructor Operator">_`⇒_</a> <a id="942" href="Prelude.Solvers.Choice.html#958" class="Bound">A</a> <a id="944" href="Prelude.Solvers.Choice.html#962" class="Bound">B</a> <a id="946" class="Symbol">=</a> <a id="948" href="Reflection.Term.html#1888" class="InductiveConstructor Operator">vΠ[</a> <a id="952" class="String">&quot;_&quot;</a> <a id="956" href="Reflection.Term.html#1888" class="InductiveConstructor Operator">∶</a> <a id="958" href="Prelude.Solvers.Choice.html#958" class="Bound">A</a> <a id="960" href="Reflection.Term.html#1888" class="InductiveConstructor Operator">]</a> <a id="962" href="Prelude.Solvers.Choice.html#962" class="Bound">B</a>

<a id="choiceSolver"></a><a id="965" href="Prelude.Solvers.Choice.html#965" class="Function">choiceSolver</a> <a id="978" class="Symbol">:</a> <a id="980" href="Prelude.Solvers.Base.html#288" class="Record">Solver</a>
<a id="987" href="Prelude.Solvers.Choice.html#965" class="Function">choiceSolver</a> <a id="1000" class="Symbol">=</a> <a id="1002" class="Symbol">λ</a> <a id="1004" class="Keyword">where</a>
  <a id="1012" class="Symbol">.</a><a id="1013" href="Prelude.Solvers.Base.html#320" class="Field">View</a> <a id="1018" class="Symbol">→</a> <a id="1020" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a>
  <a id="1027" class="Symbol">.</a><a id="1028" href="Prelude.Solvers.Base.html#335" class="Field">view</a> <a id="1033" class="Symbol">→</a> <a id="1035" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a>
  <a id="1042" class="Symbol">.</a><a id="1043" href="Prelude.Solvers.Base.html#364" class="Field">solveView</a> <a id="1053" href="Prelude.Solvers.Choice.html#1053" class="Bound">thole</a><a id="1058" class="Symbol">@(_</a> <a id="1062" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1064" href="Prelude.Solvers.Choice.html#1064" class="Bound">ty</a><a id="1066" class="Symbol">)</a> <a id="1068" href="Prelude.Solvers.Choice.html#1068" class="Bound">t</a> <a id="1070" class="Symbol">→</a> <a id="1072" class="Keyword">do</a>
    <a id="1079" href="Prelude.Solvers.Choice.html#1079" class="Bound">choices</a> <a id="1087" href="Prelude.Monad.html#567" class="Field Operator">←</a> <a id="1089" href="Prelude.Solvers.Choice.html#791" class="Function">choicesFromContext</a>
    <a id="1112" href="Prelude.Generics.html#11487" class="Function">print</a> <a id="1118" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1120" class="String">&quot;Choices: &quot;</a> <a id="1132" href="Prelude.Semigroup.html#228" class="Field Operator">◇</a> <a id="1134" href="Prelude.Show.html#321" class="Field">show</a> <a id="1139" href="Prelude.Solvers.Choice.html#1079" class="Bound">choices</a>
    <a id="1151" href="Prelude.Generics.html#11890" class="Function Operator">⋃∗</a> <a id="1154" href="Prelude.Solvers.Choice.html#1079" class="Bound">choices</a> <a id="1162" href="Prelude.Functor.html#454" class="Function Operator">&lt;&amp;&gt;</a> <a id="1166" class="Symbol">λ</a> <a id="1168" class="Symbol">(</a><a id="1169" href="Prelude.Solvers.Choice.html#1169" class="Bound">i</a> <a id="1171" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1173" class="Symbol">(</a><a id="1174" href="Prelude.Solvers.Choice.html#1174" class="Bound">A</a> <a id="1176" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1178" href="Prelude.Solvers.Choice.html#1178" class="Bound">B</a><a id="1179" class="Symbol">))</a> <a id="1182" class="Symbol">→</a> <a id="1184" class="Keyword">do</a>
      <a id="1193" href="Prelude.Solvers.Choice.html#1193" class="Bound">ctx</a> <a id="1197" href="Prelude.Monad.html#567" class="Field Operator">←</a> <a id="1199" href="Agda.Builtin.Reflection.html#8859" class="Postulate">getContext</a>
      <a id="1216" href="Prelude.Solvers.Choice.html#1216" class="Bound">hA</a> <a id="1219" href="Prelude.Monad.html#567" class="Field Operator">←</a> <a id="1221" href="Agda.Builtin.Reflection.html#8965" class="Postulate">inContext</a> <a id="1231" class="Symbol">(</a><a id="1232" href="Reflection.Argument.html#1209" class="InductiveConstructor">vArg</a> <a id="1237" href="Prelude.Solvers.Choice.html#1174" class="Bound">A</a> <a id="1239" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1241" href="Prelude.Solvers.Choice.html#1193" class="Bound">ctx</a><a id="1244" class="Symbol">)</a> <a id="1246" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1248" href="Prelude.Generics.html#11487" class="Function">print</a> <a id="1254" class="String">&quot;LEFT: &quot;</a> <a id="1263" href="Prelude.Monad.html#601" class="Function Operator">&gt;&gt;</a> <a id="1266" href="Prelude.Solvers.Choice.html#448" class="Bound">newGoal</a> <a id="1274" href="Prelude.Solvers.Choice.html#1064" class="Bound">ty</a>
      <a id="1283" href="Prelude.Solvers.Choice.html#1283" class="Bound">hB</a> <a id="1286" href="Prelude.Monad.html#567" class="Field Operator">←</a> <a id="1288" href="Agda.Builtin.Reflection.html#8965" class="Postulate">inContext</a> <a id="1298" class="Symbol">(</a><a id="1299" href="Reflection.Argument.html#1209" class="InductiveConstructor">vArg</a> <a id="1304" href="Prelude.Solvers.Choice.html#1178" class="Bound">B</a> <a id="1306" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1308" href="Prelude.Solvers.Choice.html#1193" class="Bound">ctx</a><a id="1311" class="Symbol">)</a> <a id="1313" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1315" href="Prelude.Generics.html#11487" class="Function">print</a> <a id="1321" class="String">&quot;RIGHT: &quot;</a> <a id="1331" href="Prelude.Monad.html#601" class="Function Operator">&gt;&gt;</a> <a id="1334" href="Prelude.Solvers.Choice.html#448" class="Bound">newGoal</a> <a id="1342" href="Prelude.Solvers.Choice.html#1064" class="Bound">ty</a>
      <a id="1351" href="Prelude.Generics.html#17390" class="Function">unifyStrict</a> <a id="1363" href="Prelude.Solvers.Choice.html#1053" class="Bound">thole</a> <a id="1369" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1371" class="Keyword">quote</a> <a id="1377" href="Data.Sum.Base.html#1089" class="Function Operator">Sum.[_,_]′</a> <a id="1388" href="Prelude.Generics.html#2818" class="InductiveConstructor Operator">∙⟦</a> <a id="1391" href="Prelude.Solvers.Choice.html#1216" class="Bound">hA</a> <a id="1394" href="Prelude.Generics.html#2818" class="InductiveConstructor Operator">∣</a> <a id="1396" href="Prelude.Solvers.Choice.html#1283" class="Bound">hB</a> <a id="1399" href="Prelude.Generics.html#2818" class="InductiveConstructor Operator">∣</a> <a id="1401" href="Prelude.Generics.html#841" class="InductiveConstructor">♯</a> <a id="1403" href="Prelude.Solvers.Choice.html#1169" class="Bound">i</a> <a id="1405" href="Prelude.Generics.html#2818" class="InductiveConstructor Operator">⟧</a>
      <a id="1413" class="Comment">-- thole := (A `⇒ C) ∣ (B `⇒ C) ∋ λ ◆ ◇ → quote Sum.[_,_]′ ∙⟦ ◆ ∣ ◇ ∣ ♯ i ⟧</a>
</pre></body></html>