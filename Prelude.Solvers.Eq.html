<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Prelude.Solvers.Eq</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/formal-prelude/tree/master/Prelude/Solvers/Eq.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="52" class="Keyword">open</a> <a id="57" class="Keyword">import</a> <a id="64" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="80" class="Keyword">open</a> <a id="85" class="Keyword">import</a> <a id="92" href="Prelude.Semigroup.html" class="Module">Prelude.Semigroup</a>
<a id="110" class="Keyword">open</a> <a id="115" class="Keyword">import</a> <a id="122" href="Prelude.Applicative.html" class="Module">Prelude.Applicative</a>
<a id="142" class="Keyword">open</a> <a id="147" class="Keyword">import</a> <a id="154" href="Prelude.Monad.html" class="Module">Prelude.Monad</a>
<a id="168" class="Keyword">open</a> <a id="173" class="Keyword">import</a> <a id="180" href="Prelude.Show.html" class="Module">Prelude.Show</a>
<a id="193" class="Keyword">open</a> <a id="198" class="Keyword">import</a> <a id="205" href="Prelude.Nary.html" class="Module">Prelude.Nary</a>

<a id="219" class="Keyword">open</a> <a id="224" class="Keyword">import</a> <a id="231" href="Prelude.Generics.html" class="Module">Prelude.Generics</a>
<a id="248" class="Keyword">open</a> <a id="253" href="Prelude.Init.html#11000" class="Module">Meta</a>
<a id="258" class="Keyword">open</a> <a id="263" href="Prelude.Generics.html#10126" class="Module">Debug</a> <a id="269" class="Symbol">(</a><a id="270" class="String">&quot;Generics.Solvers.Eq&quot;</a> <a id="292" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="294" class="Number">100</a><a id="297" class="Symbol">)</a>

<a id="300" class="Keyword">open</a> <a id="305" class="Keyword">import</a> <a id="312" href="Prelude.Solvers.Base.html" class="Module">Prelude.Solvers.Base</a>

<a id="334" class="Keyword">module</a> <a id="341" href="Prelude.Solvers.Eq.html" class="Module">Prelude.Solvers.Eq</a>
  <a id="362" class="Symbol">(</a><a id="363" href="Prelude.Solvers.Eq.html#363" class="Bound">newGoal</a> <a id="371" class="Symbol">:</a> <a id="373" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a> <a id="378" class="Symbol">→</a> <a id="380" href="Agda.Builtin.Reflection.html#8218" class="Postulate">TC</a> <a id="383" href="Prelude.Generics.html#8831" class="Function">Hole</a><a id="387" class="Symbol">)</a>
  <a id="391" class="Symbol">(</a><a id="392" href="Prelude.Solvers.Eq.html#392" class="Bound Operator">_:=_∋_</a> <a id="399" class="Symbol">:</a> <a id="401" href="Prelude.Generics.html#8844" class="Function">THole</a> <a id="407" class="Symbol">→</a> <a id="409" href="Agda.Builtin.Reflection.html#4759" class="Function">Type</a> <a id="414" class="Symbol">→</a> <a id="416" href="Prelude.Solvers.Base.html#1080" class="Function">TermCtx</a> <a id="424" class="Symbol">→</a> <a id="426" href="Agda.Builtin.Reflection.html#8218" class="Postulate">TC</a> <a id="429" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a><a id="430" class="Symbol">)</a>
  <a id="434" class="Keyword">where</a>

<a id="441" class="Keyword">data</a> <a id="ViewEq"></a><a id="446" href="Prelude.Solvers.Eq.html#446" class="Datatype">ViewEq</a> <a id="453" class="Symbol">:</a> <a id="455" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="459" class="Keyword">where</a>
  <a id="ViewEq._`≡_"></a><a id="467" href="Prelude.Solvers.Eq.html#467" class="InductiveConstructor Operator">_`≡_</a> <a id="472" class="Symbol">:</a> <a id="474" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a> <a id="479" class="Symbol">→</a> <a id="481" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a> <a id="486" class="Symbol">→</a> <a id="488" href="Prelude.Solvers.Eq.html#446" class="Datatype">ViewEq</a>

<a id="viewEq"></a><a id="496" href="Prelude.Solvers.Eq.html#496" class="Function">viewEq</a> <a id="503" class="Symbol">:</a> <a id="505" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a> <a id="510" class="Symbol">→</a> <a id="512" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="518" href="Prelude.Solvers.Eq.html#446" class="Datatype">ViewEq</a>
<a id="525" href="Prelude.Solvers.Eq.html#496" class="Function">viewEq</a> <a id="532" class="Symbol">=</a> <a id="534" class="Symbol">λ</a> <a id="536" class="Keyword">where</a>
  <a id="544" class="Symbol">(</a><a id="545" href="Agda.Builtin.Reflection.html#4903" class="InductiveConstructor">def</a> <a id="549" class="Symbol">(</a><a id="550" class="Keyword">quote</a> <a id="556" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="559" class="Symbol">)</a> <a id="561" class="Symbol">(</a><a id="562" href="Reflection.Argument.html#1271" class="InductiveConstructor">hArg</a> <a id="567" class="Symbol">_</a> <a id="569" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="571" href="Reflection.Argument.html#1271" class="InductiveConstructor">hArg</a> <a id="576" class="Symbol">_</a> <a id="578" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="580" href="Reflection.Argument.html#1209" class="InductiveConstructor">vArg</a> <a id="585" href="Prelude.Solvers.Eq.html#585" class="Bound">x</a> <a id="587" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="589" href="Reflection.Argument.html#1209" class="InductiveConstructor">vArg</a> <a id="594" href="Prelude.Solvers.Eq.html#594" class="Bound">y</a> <a id="596" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="598" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="600" class="Symbol">))</a> <a id="603" class="Symbol">→</a> <a id="605" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="610" class="Symbol">(</a><a id="611" href="Prelude.Solvers.Eq.html#585" class="Bound">x</a> <a id="613" href="Prelude.Solvers.Eq.html#467" class="InductiveConstructor Operator">`≡</a> <a id="616" href="Prelude.Solvers.Eq.html#594" class="Bound">y</a><a id="617" class="Symbol">)</a>
  <a id="621" class="CatchallClause Symbol">_</a> <a id="623" class="Symbol">→</a> <a id="625" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>

<a id="solveEq"></a><a id="634" href="Prelude.Solvers.Eq.html#634" class="Function">solveEq</a> <a id="642" class="Symbol">:</a> <a id="644" href="Prelude.Generics.html#8844" class="Function">THole</a> <a id="650" class="Symbol">→</a> <a id="652" href="Prelude.Solvers.Eq.html#446" class="Datatype">ViewEq</a> <a id="659" class="Symbol">→</a> <a id="661" href="Agda.Builtin.Reflection.html#8218" class="Postulate">TC</a> <a id="664" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="666" href="Prelude.Solvers.Eq.html#634" class="Function">solveEq</a> <a id="674" class="Symbol">(</a><a id="675" href="Prelude.Solvers.Eq.html#675" class="Bound">hole</a> <a id="680" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="682" class="Symbol">_)</a> <a id="685" class="Symbol">(</a><a id="686" href="Prelude.Solvers.Eq.html#686" class="Bound">x</a> <a id="688" href="Prelude.Solvers.Eq.html#467" class="InductiveConstructor Operator">`≡</a> <a id="691" href="Prelude.Solvers.Eq.html#691" class="Bound">y</a><a id="692" class="Symbol">)</a> <a id="694" class="Symbol">=</a> <a id="696" class="Keyword">do</a>
  <a id="701" href="Prelude.Generics.html#10246" class="Function">print</a> <a id="707" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="709" href="Prelude.Show.html#315" class="Field">show</a> <a id="714" href="Prelude.Solvers.Eq.html#686" class="Bound">x</a> <a id="716" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="718" class="String">&quot; =? &quot;</a> <a id="725" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="727" href="Prelude.Show.html#315" class="Field">show</a> <a id="732" href="Prelude.Solvers.Eq.html#691" class="Bound">y</a>
  <a id="736" href="Prelude.Solvers.Eq.html#736" class="Bound">x</a> <a id="738" href="Prelude.Monad.html#544" class="Field Operator">←</a> <a id="740" href="Agda.Builtin.Reflection.html#8573" class="Postulate">normalise</a> <a id="750" href="Prelude.Solvers.Eq.html#686" class="Bound">x</a>
  <a id="754" href="Prelude.Solvers.Eq.html#754" class="Bound">y</a> <a id="756" href="Prelude.Monad.html#544" class="Field Operator">←</a> <a id="758" href="Agda.Builtin.Reflection.html#8573" class="Postulate">normalise</a> <a id="768" href="Prelude.Solvers.Eq.html#691" class="Bound">y</a>
  <a id="772" href="Prelude.Generics.html#10246" class="Function">print</a> <a id="778" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="780" class="String">&quot; ↝ &quot;</a> <a id="786" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="788" href="Prelude.Show.html#315" class="Field">show</a> <a id="793" href="Prelude.Solvers.Eq.html#736" class="Bound">x</a> <a id="795" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="797" class="String">&quot; =? &quot;</a> <a id="804" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="806" href="Prelude.Show.html#315" class="Field">show</a> <a id="811" href="Prelude.Solvers.Eq.html#754" class="Bound">y</a>
  <a id="815" href="Prelude.Solvers.Eq.html#1161" class="Function">tryEq</a> <a id="821" class="Symbol">(</a><a id="822" href="Prelude.Solvers.Eq.html#736" class="Bound">x</a> <a id="824" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="826" href="Prelude.Solvers.Eq.html#754" class="Bound">y</a><a id="827" class="Symbol">)</a> <a id="829" href="Prelude.Applicative.html#2898" class="Field Operator">&lt;|&gt;</a> <a id="833" href="Prelude.Solvers.Eq.html#862" class="Function">decideEq</a> <a id="842" class="Symbol">(</a><a id="843" href="Prelude.Solvers.Eq.html#736" class="Bound">x</a> <a id="845" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="847" href="Prelude.Solvers.Eq.html#754" class="Bound">y</a><a id="848" class="Symbol">)</a>
  <a id="852" class="Keyword">where</a>
    <a id="862" href="Prelude.Solvers.Eq.html#862" class="Function">decideEq</a> <a id="871" class="Symbol">:</a> <a id="873" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a> <a id="878" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="880" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a> <a id="885" class="Symbol">→</a> <a id="887" href="Agda.Builtin.Reflection.html#8218" class="Postulate">TC</a> <a id="890" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
    <a id="896" href="Prelude.Solvers.Eq.html#862" class="Function">decideEq</a> <a id="905" class="Symbol">(</a><a id="906" href="Prelude.Solvers.Eq.html#906" class="Bound">x</a> <a id="908" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="910" href="Prelude.Solvers.Eq.html#910" class="Bound">y</a><a id="911" class="Symbol">)</a> <a id="913" class="Symbol">=</a> <a id="915" class="Keyword">do</a>
      <a id="924" class="Keyword">let</a> <a id="928" href="Prelude.Solvers.Eq.html#928" class="Bound">x≡y</a> <a id="932" class="Symbol">=</a> <a id="934" class="Keyword">quote</a> <a id="940" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a> <a id="944" href="Prelude.Generics.html#2735" class="InductiveConstructor Operator">∙⟦</a> <a id="947" href="Prelude.Solvers.Eq.html#906" class="Bound">x</a> <a id="949" href="Prelude.Generics.html#2735" class="InductiveConstructor Operator">∣</a> <a id="951" href="Prelude.Solvers.Eq.html#910" class="Bound">y</a> <a id="953" href="Prelude.Generics.html#2735" class="InductiveConstructor Operator">⟧</a>
      <a id="961" class="Keyword">let</a> <a id="965" href="Prelude.Solvers.Eq.html#965" class="Bound">x≟y</a> <a id="969" class="Symbol">=</a> <a id="971" class="Keyword">quote</a> <a id="977" href="Prelude.DecEq.Core.html#137" class="Field Operator">_≟_</a> <a id="981" href="Prelude.Generics.html#2735" class="InductiveConstructor Operator">∙⟦</a> <a id="984" href="Prelude.Solvers.Eq.html#906" class="Bound">x</a> <a id="986" href="Prelude.Generics.html#2735" class="InductiveConstructor Operator">∣</a> <a id="988" href="Prelude.Solvers.Eq.html#910" class="Bound">y</a> <a id="990" href="Prelude.Generics.html#2735" class="InductiveConstructor Operator">⟧</a>
      <a id="998" href="Prelude.Generics.html#15788" class="Function">unifyStrict</a> <a id="1010" class="Symbol">(</a><a id="1011" href="Prelude.Solvers.Eq.html#675" class="Bound">hole</a> <a id="1016" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1018" href="Prelude.Solvers.Eq.html#928" class="Bound">x≡y</a><a id="1021" class="Symbol">)</a> <a id="1023" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1025" href="Agda.Builtin.Reflection.html#4903" class="InductiveConstructor">def</a> <a id="1029" class="Symbol">(</a><a id="1030" class="Keyword">quote</a> <a id="1036" href="Relation.Nullary.Decidable.Core.html#1484" class="Function">toWitness</a><a id="1045" class="Symbol">)</a> <a id="1047" class="Symbol">(</a><a id="1048" href="Prelude.Generics.html#710" class="InductiveConstructor">hArg?</a> <a id="1054" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1056" href="Reflection.Argument.html#1271" class="InductiveConstructor">hArg</a> <a id="1061" href="Prelude.Solvers.Eq.html#928" class="Bound">x≡y</a> <a id="1065" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1067" href="Reflection.Argument.html#1271" class="InductiveConstructor">hArg</a> <a id="1072" href="Prelude.Solvers.Eq.html#965" class="Bound">x≟y</a> <a id="1076" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1078" href="Reflection.Argument.html#1209" class="InductiveConstructor">vArg</a> <a id="1083" class="Symbol">(</a><a id="1084" class="Keyword">quote</a> <a id="1090" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a> <a id="1093" href="Prelude.Generics.html#2855" class="InductiveConstructor Operator">◆</a><a id="1094" class="Symbol">)</a> <a id="1096" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1098" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1100" class="Symbol">)</a>
      <a id="1108" href="Prelude.Generics.html#10252" class="Function">printLn</a> <a id="1116" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1118" class="String">&quot;[by-dec] &quot;</a> <a id="1130" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="1132" href="Prelude.Show.html#315" class="Field">show</a> <a id="1137" href="Prelude.Solvers.Eq.html#906" class="Bound">x</a> <a id="1139" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="1141" class="String">&quot; ≟ &quot;</a> <a id="1147" href="Prelude.Semigroup.html#158" class="Field Operator">◇</a> <a id="1149" href="Prelude.Show.html#315" class="Field">show</a> <a id="1154" href="Prelude.Solvers.Eq.html#910" class="Bound">y</a>

    <a id="1161" href="Prelude.Solvers.Eq.html#1161" class="Function">tryEq</a> <a id="1167" class="Symbol">:</a> <a id="1169" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a> <a id="1174" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1176" href="Agda.Builtin.Reflection.html#4688" class="Datatype">Term</a> <a id="1181" class="Symbol">→</a> <a id="1183" href="Agda.Builtin.Reflection.html#8218" class="Postulate">TC</a> <a id="1186" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
    <a id="1192" href="Prelude.Solvers.Eq.html#1161" class="Function">tryEq</a> <a id="1198" class="Symbol">(</a><a id="1199" href="Prelude.Solvers.Eq.html#1199" class="Bound">x</a> <a id="1201" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1203" href="Prelude.Solvers.Eq.html#1203" class="Bound">y</a><a id="1204" class="Symbol">)</a> <a id="1206" class="Symbol">=</a>
      <a id="1214" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="1217" href="Prelude.Solvers.Eq.html#1199" class="Bound">x</a> <a id="1219" href="Prelude.DecEq.Core.html#169" class="Function Operator">==</a> <a id="1222" href="Prelude.Solvers.Eq.html#1203" class="Bound">y</a> <a id="1224" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="1229" class="Symbol">(</a><a id="1230" class="Keyword">do</a>
        <a id="1241" href="Prelude.Generics.html#10252" class="Function">printLn</a> <a id="1249" class="String">&quot;[by-refl] terms are exactly equal&quot;</a>
        <a id="1293" href="Prelude.Generics.html#15788" class="Function">unifyStrict</a> <a id="1305" class="Symbol">(</a><a id="1306" href="Prelude.Solvers.Eq.html#675" class="Bound">hole</a> <a id="1311" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1313" class="Keyword">quote</a> <a id="1319" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a> <a id="1323" href="Prelude.Generics.html#2735" class="InductiveConstructor Operator">∙⟦</a> <a id="1326" href="Prelude.Solvers.Eq.html#1199" class="Bound">x</a> <a id="1328" href="Prelude.Generics.html#2735" class="InductiveConstructor Operator">∣</a> <a id="1330" href="Prelude.Solvers.Eq.html#1203" class="Bound">y</a> <a id="1332" href="Prelude.Generics.html#2735" class="InductiveConstructor Operator">⟧</a><a id="1333" class="Symbol">)</a> <a id="1335" class="Symbol">(</a><a id="1336" class="Keyword">quote</a> <a id="1342" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1347" href="Prelude.Generics.html#2855" class="InductiveConstructor Operator">◆</a><a id="1348" class="Symbol">)</a>
        <a id="1358" class="Symbol">)</a>
      <a id="1366" class="Comment">-- else if == swap</a>
      <a id="1391" class="Comment">--   print &quot;tryEq: terms are swapped, applying commutativity...&quot;</a>
      <a id="1462" class="Comment">--   ...</a>
      <a id="1477" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="1482" href="Prelude.Generics.html#10008" class="Function">error</a> <a id="1488" class="String">&quot;tryEq: terms are not exactly equal, cannot apply reflexivity&quot;</a>

<a id="Solver-Eq"></a><a id="1552" href="Prelude.Solvers.Eq.html#1552" class="Function">Solver-Eq</a> <a id="1562" class="Symbol">:</a> <a id="1564" href="Prelude.Solvers.Base.html#288" class="Record">Solver</a>
<a id="1571" href="Prelude.Solvers.Eq.html#1552" class="Function">Solver-Eq</a> <a id="1581" class="Symbol">=</a> <a id="1583" class="Symbol">λ</a> <a id="1585" class="Keyword">where</a>
  <a id="1593" class="Symbol">.</a><a id="1594" href="Prelude.Solvers.Base.html#320" class="Field">View</a> <a id="1599" class="Symbol">→</a> <a id="1601" href="Prelude.Solvers.Eq.html#446" class="Datatype">ViewEq</a>
  <a id="1610" class="Symbol">.</a><a id="1611" href="Prelude.Solvers.Base.html#335" class="Field">view</a> <a id="1616" class="Symbol">→</a> <a id="1618" href="Prelude.Solvers.Eq.html#496" class="Function">viewEq</a>
  <a id="1627" class="Symbol">.</a><a id="1628" href="Prelude.Solvers.Base.html#364" class="Field">solveView</a> <a id="1638" class="Symbol">→</a> <a id="1640" href="Prelude.Solvers.Eq.html#634" class="Function">solveEq</a>
</pre></body></html>